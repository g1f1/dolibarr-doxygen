<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dolibarr: htdocs/fourn/facture/list.php Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../dolibarr.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dolibarr
   &#160;<span id="projectnumber">develop</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('da/d9b/fourn_2facture_2list_8php_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">list.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d9b/fourn_2facture_2list_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* Copyright (C) 2002-2006  Rodolphe Quiedeville    &lt;rodolphe@quiedeville.org&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2004-2019  Laurent Destailleur     &lt;eldy@users.sourceforge.net&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 2005-2013  Regis Houssin           &lt;regis.houssin@inodbox.com&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Copyright (C) 2013-2019  Philippe Grand          &lt;philippe.grand@atoo-net.com&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Copyright (C) 2013       Florian Henry           &lt;florian.henry@open-concept.pro&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * Copyright (C) 2013       Cédric Salvador         &lt;csalvador@gpcsolutions.fr&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Copyright (C) 2015       Marcos García           &lt;marcosgdf@gmail.com&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Copyright (C) 2015-2007  Juanjo Menent           &lt;jmenent@2byte.es&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Copyright (C) 2015       Abbes Bahfir            &lt;bafbes@gmail.com&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * Copyright (C) 2015-2016  Ferran Marcet           &lt;fmarcet@2byte.es&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Copyright (C) 2017       Josep Lluís Amador      &lt;joseplluis@lliuretic.cat&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * Copyright (C) 2018       Charlene Benke          &lt;charlie@patas-monkey.com&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * Copyright (C) 2018-2020  Frédéric France         &lt;frederic.france@netlogic.fr&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * Copyright (C) 2019-2021  Alexandre Spangaro      &lt;aspangaro@open-dsi.fr&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * the Free Software Foundation; either version 3 of the License, or</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * along with this program. If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;require <span class="stringliteral">&#39;../../main.inc.php&#39;</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/class/html.formfile.class.php&#39;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/class/html.formother.class.php&#39;</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/class/html.formcompany.class.php&#39;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/compta/bank/class/account.class.php&#39;</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/fourn/class/fournisseur.facture.class.php&#39;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/fourn/class/fournisseur.class.php&#39;</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/lib/date.lib.php&#39;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/lib/company.lib.php&#39;</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/projet/class/project.class.php&#39;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// Load translation files required by the page</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;$langs-&gt;loadLangs(array(<span class="stringliteral">&#39;products&#39;</span>, <span class="stringliteral">&#39;bills&#39;</span>, <span class="stringliteral">&#39;companies&#39;</span>, <span class="stringliteral">&#39;projects&#39;</span>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;$action = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;action&#39;</span>, <span class="stringliteral">&#39;aZ09&#39;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;$massaction = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;massaction&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;$show_files = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;show_files&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;$confirm = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;confirm&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;$toselect = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;toselect&#39;</span>, <span class="stringliteral">&#39;array&#39;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;$optioncss = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;optioncss&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;$contextpage = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;contextpage&#39;</span>, <span class="stringliteral">&#39;aZ&#39;</span>) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;contextpage&#39;</span>, <span class="stringliteral">&#39;aZ&#39;</span>) : <span class="stringliteral">&#39;supplierinvoicelist&#39;</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;$socid = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;socid&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// Security check</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">if</span> ($user-&gt;socid &gt; 0) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    $action = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    $_GET[<span class="stringliteral">&quot;action&quot;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    $socid = $user-&gt;socid;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;$mode = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;mode&quot;</span>, <span class="stringliteral">&#39;aZ09&#39;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;$search_all = trim((<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_all&#39;</span>, <span class="stringliteral">&#39;alphanohtml&#39;</span>) != <span class="stringliteral">&#39;&#39;</span>) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_all&#39;</span>, <span class="stringliteral">&#39;alphanohtml&#39;</span>) : <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;sall&#39;</span>, <span class="stringliteral">&#39;alphanohtml&#39;</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;$search_label = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_label&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;$search_amount_no_tax = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_amount_no_tax&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;$search_amount_all_tax = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_amount_all_tax&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;$search_product_category = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_product_category&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;$search_ref = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;sf_ref&#39;</span>) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;sf_ref&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>) : <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_ref&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;$search_refsupplier = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_refsupplier&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;$search_type = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_type&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;$search_project = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_project&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;$search_company = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_company&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;$search_montant_ht = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_montant_ht&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;$search_montant_vat = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_montant_vat&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;$search_montant_localtax1 = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_montant_localtax1&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;$search_montant_localtax2 = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_montant_localtax2&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;$search_montant_ttc = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_montant_ttc&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;$search_login = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_login&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;$search_multicurrency_code = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_multicurrency_code&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;$search_multicurrency_tx = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_multicurrency_tx&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;$search_multicurrency_montant_ht = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_multicurrency_montant_ht&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;$search_multicurrency_montant_vat = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_multicurrency_montant_vat&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;$search_multicurrency_montant_ttc = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_multicurrency_montant_ttc&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;$search_status = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_status&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;$search_paymentmode = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_paymentmode&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;$search_paymentcond = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_paymentcond&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;$search_town = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_town&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;$search_zip = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_zip&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;$search_state = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_state&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;$search_country = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_country&quot;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;$search_type_thirdparty = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_type_thirdparty&quot;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;$search_user = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_user&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;$search_sale = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_sale&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;$search_date_startday = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_startday&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;$search_date_startmonth = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_startmonth&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;$search_date_startyear = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_startyear&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;$search_date_endday = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_endday&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;$search_date_endmonth = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_endmonth&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;$search_date_endyear = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_date_endyear&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;$search_date_start = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a09ae0028df30935f6a6f7d5ae05f42bd">dol_mktime</a>(0, 0, 0, $search_date_startmonth, $search_date_startday, $search_date_startyear);   <span class="comment">// Use tzserver</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;$search_date_end = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a09ae0028df30935f6a6f7d5ae05f42bd">dol_mktime</a>(23, 59, 59, $search_date_endmonth, $search_date_endday, $search_date_endyear);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;$search_datelimit_startday = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_startday&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;$search_datelimit_startmonth = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_startmonth&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;$search_datelimit_startyear = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_startyear&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;$search_datelimit_endday = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_endday&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;$search_datelimit_endmonth = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_endmonth&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;$search_datelimit_endyear = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_datelimit_endyear&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;$search_datelimit_start = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a09ae0028df30935f6a6f7d5ae05f42bd">dol_mktime</a>(0, 0, 0, $search_datelimit_startmonth, $search_datelimit_startday, $search_datelimit_startyear);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;$search_datelimit_end = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a09ae0028df30935f6a6f7d5ae05f42bd">dol_mktime</a>(23, 59, 59, $search_datelimit_endmonth, $search_datelimit_endday, $search_datelimit_endyear);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;$toselect = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;toselect&#39;</span>, <span class="stringliteral">&#39;array&#39;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;$search_btn = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;button_search&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;$search_remove_btn = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;button_removefilter&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;$search_categ_sup = trim(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;search_categ_sup&quot;</span>, <span class="stringliteral">&#39;int&#39;</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;$option = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;search_option&#39;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordflow">if</span> ($option == <span class="stringliteral">&#39;late&#39;</span>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    $search_status = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;$filter = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;filtre&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;$limit = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;limit&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;limit&#39;</span>, <span class="stringliteral">&#39;int&#39;</span>) : $conf-&gt;liste_limit;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;$sortfield = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;sortfield&quot;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;$sortorder = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;sortorder&quot;</span>, <span class="stringliteral">&#39;alpha&#39;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;$page = <a class="code" href="../../d9/d69/functions_8lib_8php.html#aca64a844ce2ad30d4fc49cd4b957cbdf">GETPOSTISSET</a>(<span class="stringliteral">&#39;pageplusone&#39;</span>) ? (<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;pageplusone&#39;</span>) - 1) : <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&quot;page&quot;</span>, <span class="stringliteral">&#39;int&#39;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordflow">if</span> ($page == -1 || $page == <span class="keyword">null</span> || !empty($search_btn) || !empty($search_remove_btn) || (empty($toselect) &amp;&amp; $massaction === <span class="charliteral">&#39;0&#39;</span>)) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    $page = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;$offset = $limit * $page;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;$pageprev = $page - 1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;$pagenext = $page + 1;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">if</span> (!$sortorder) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    $sortorder = <span class="stringliteral">&quot;DESC&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordflow">if</span> (!$sortfield) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    $sortfield = <span class="stringliteral">&quot;f.datef,f.rowid&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;$diroutputmassaction = $conf-&gt;fournisseur-&gt;facture-&gt;dir_output.<span class="stringliteral">&#39;/temp/massgeneration/&#39;</span>.$user-&gt;id;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;$now = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// Initialize technical object to manage hooks of page. Note that conf-&gt;hooks_modules contains array of hook context</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;$object = <span class="keyword">new</span> <a class="code" href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a>($db);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;$hookmanager-&gt;initHooks(array(<span class="stringliteral">&#39;supplierinvoicelist&#39;</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;$extrafields = <span class="keyword">new</span> <a class="code" href="../../d3/dbf/class_extra_fields.html">ExtraFields</a>($db);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// fetch optionals attributes and labels</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;$extrafields-&gt;fetch_name_optionals_label($object-&gt;table_element);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;$search_array_options = $extrafields-&gt;getOptionalsFromPost($object-&gt;table_element, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;search_&#39;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">// List of fields to search into when doing a &quot;search in all&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;$fieldstosearchall = array(</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="stringliteral">&#39;f.ref&#39;</span>=&gt;<span class="stringliteral">&#39;Ref&#39;</span>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="stringliteral">&#39;f.ref_supplier&#39;</span>=&gt;<span class="stringliteral">&#39;RefSupplier&#39;</span>,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="stringliteral">&#39;pd.description&#39;</span>=&gt;<span class="stringliteral">&#39;Description&#39;</span>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="stringliteral">&#39;s.nom&#39;</span>=&gt;<span class="stringliteral">&quot;ThirdParty&quot;</span>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="stringliteral">&#39;f.note_public&#39;</span>=&gt;<span class="stringliteral">&#39;NotePublic&#39;</span>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordflow">if</span> (empty($user-&gt;socid)) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    $fieldstosearchall[<span class="stringliteral">&quot;f.note_private&quot;</span>] = <span class="stringliteral">&quot;NotePrivate&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;$checkedtypetiers = 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;$arrayfields = array(</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="stringliteral">&#39;f.ref&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Ref&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="stringliteral">&#39;f.ref_supplier&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;RefSupplier&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="stringliteral">&#39;f.type&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="stringliteral">&#39;f.label&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Label&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="stringliteral">&#39;f.datef&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;DateInvoice&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="stringliteral">&#39;f.date_lim_reglement&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;DateDue&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="stringliteral">&#39;p.ref&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;ProjectRef&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="stringliteral">&#39;s.nom&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;ThirdParty&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="stringliteral">&#39;s.town&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Town&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;-1),</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="stringliteral">&#39;s.zip&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Zip&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="stringliteral">&#39;state.nom&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;StateShort&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="stringliteral">&#39;country.code_iso&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Country&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="stringliteral">&#39;typent.code&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;ThirdPartyType&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;$checkedtypetiers),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="stringliteral">&#39;f.fk_cond_reglement&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;PaymentTerm&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1, <span class="stringliteral">&#39;position&#39;</span>=&gt;50),</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="stringliteral">&#39;f.fk_mode_reglement&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;PaymentMode&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1, <span class="stringliteral">&#39;position&#39;</span>=&gt;52),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="stringliteral">&#39;f.total_ht&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;AmountHT&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1, <span class="stringliteral">&#39;position&#39;</span>=&gt;105),</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="stringliteral">&#39;f.total_vat&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;AmountVAT&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;position&#39;</span>=&gt;110),</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="stringliteral">&#39;f.total_localtax1&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;$langs-&gt;transcountry(<span class="stringliteral">&quot;AmountLT1&quot;</span>, $mysoc-&gt;country_code), <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;$mysoc-&gt;localtax1_assuj == <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&#39;position&#39;</span>=&gt;95),</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="stringliteral">&#39;f.total_localtax2&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;$langs-&gt;transcountry(<span class="stringliteral">&quot;AmountLT2&quot;</span>, $mysoc-&gt;country_code), <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;$mysoc-&gt;localtax2_assuj == <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&#39;position&#39;</span>=&gt;100),</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="stringliteral">&#39;f.total_ttc&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;AmountTTC&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;position&#39;</span>=&gt;115),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="stringliteral">&#39;u.login&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Author&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1),</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="stringliteral">&#39;dynamount_payed&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Paid&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="stringliteral">&#39;rtp&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Rest&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0),</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="stringliteral">&#39;f.multicurrency_code&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;Currency&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;CurrencyRate&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;MulticurrencyAmountHT&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="stringliteral">&#39;f.multicurrency_total_vat&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;MulticurrencyAmountVAT&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;MulticurrencyAmountTTC&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="stringliteral">&#39;multicurrency_dynamount_payed&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;MulticurrencyAlreadyPaid&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="stringliteral">&#39;multicurrency_rtp&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;MulticurrencyRemainderToPay&#39;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;enabled&#39;</span>=&gt;(empty($conf-&gt;multicurrency-&gt;enabled) ? 0 : 1)), <span class="comment">// Not enabled by default because slow</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="stringliteral">&#39;f.datec&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;DateCreation&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;position&#39;</span>=&gt;500),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="stringliteral">&#39;f.tms&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;DateModificationShort&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;0, <span class="stringliteral">&#39;position&#39;</span>=&gt;500),</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="stringliteral">&#39;f.fk_statut&#39;</span>=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&quot;Status&quot;</span>, <span class="stringliteral">&#39;checked&#39;</span>=&gt;1, <span class="stringliteral">&#39;position&#39;</span>=&gt;1000),</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">// Extra fields</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_array_fields.tpl.php&#39;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;$object-&gt;fields = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a6b591763a56a351b27fe6575fb3d664d">dol_sort_array</a>($object-&gt;fields, <span class="stringliteral">&#39;position&#39;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;$arrayfields = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a6b591763a56a351b27fe6575fb3d664d">dol_sort_array</a>($arrayfields, <span class="stringliteral">&#39;position&#39;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">if</span> ((empty($conf-&gt;fournisseur-&gt;enabled) &amp;&amp; empty($conf-&gt;global-&gt;MAIN_USE_NEW_SUPPLIERMOD))</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    || (empty($conf-&gt;supplier_invoice-&gt;enabled) &amp;&amp; !empty($conf-&gt;global-&gt;MAIN_USE_NEW_SUPPLIERMOD))) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../dd/df3/security_8lib_8php.html#ade2525beed17cc74b84932ff7483231d">accessforbidden</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">if</span> ((empty($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;lire) &amp;&amp; empty($conf-&gt;global-&gt;MAIN_USE_NEW_SUPPLIERMOD))</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    || (empty($user-&gt;rights-&gt;supplier_invoice-&gt;lire) &amp;&amp; !empty($conf-&gt;global-&gt;MAIN_USE_NEW_SUPPLIERMOD))) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="../../dd/df3/security_8lib_8php.html#ade2525beed17cc74b84932ff7483231d">accessforbidden</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> * Actions</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;cancel&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>)) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    $action = <span class="stringliteral">&#39;list&#39;</span>; $massaction = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordflow">if</span> (!<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;confirmmassaction&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>) &amp;&amp; $massaction != <span class="stringliteral">&#39;presend&#39;</span> &amp;&amp; $massaction != <span class="stringliteral">&#39;confirm_presend&#39;</span> &amp;&amp; $massaction != <span class="stringliteral">&#39;confirm_createbills&#39;</span>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    $massaction = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;$parameters = array(<span class="stringliteral">&#39;socid&#39;</span>=&gt;$socid);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;$reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;doActions&#39;</span>, $parameters, $object, $action); <span class="comment">// Note that $action and $object may have been modified by some hooks</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">if</span> ($reshook &lt; 0) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($hookmanager-&gt;error, $hookmanager-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordflow">if</span> (empty($reshook)) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/actions_changeselectedfields.inc.php&#39;</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;button_removefilter_x&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>) || <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;button_removefilter&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>) || <a class="code" href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a>(<span class="stringliteral">&#39;button_removefilter.x&#39;</span>, <span class="stringliteral">&#39;alpha&#39;</span>)) {        <span class="comment">// All tests must be present to be compatible with all browsers</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        $search_all = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        $search_user = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        $search_sale = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        $search_product_category = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        $search_ref = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        $search_refsupplier = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        $search_type = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        $search_label = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        $search_project = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        $search_company = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        $search_amount_no_tax = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        $search_amount_all_tax = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        $search_montant_ht = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        $search_montant_vat = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        $search_montant_localtax1 = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        $search_montant_localtax2 = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        $search_montant_ttc = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        $search_login = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        $search_multicurrency_code = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        $search_multicurrency_tx = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        $search_multicurrency_montant_ht = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        $search_multicurrency_montant_vat = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        $search_multicurrency_montant_ttc = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        $search_status = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        $search_paymentmode = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        $search_paymentcond = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        $search_town = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        $search_zip = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        $search_state = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        $search_type = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        $search_country = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        $search_type_thirdparty = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        $search_date_startday = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        $search_date_startmonth = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        $search_date_startyear = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        $search_date_endday = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        $search_date_endmonth = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        $search_date_endyear = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        $search_date_start = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        $search_date_end = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        $search_datelimit_startday = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        $search_datelimit_startmonth = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        $search_datelimit_startyear = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        $search_datelimit_endday = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        $search_datelimit_endmonth = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        $search_datelimit_endyear = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        $search_datelimit_start = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        $search_datelimit_end = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        $toselect = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        $search_array_options = array();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        $filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        $option = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        $socid = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        $search_categ_sup = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// Mass actions</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    $objectclass = <span class="stringliteral">&#39;FactureFournisseur&#39;</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    $objectlabel = <span class="stringliteral">&#39;SupplierInvoices&#39;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    $permissiontoread = ($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;lire || $user-&gt;rights-&gt;supplier_invoice-&gt;lire);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    $permissiontoadd = ($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;creer || $user-&gt;rights-&gt;supplier_invoice-&gt;creer);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    $permissiontodelete = ($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;supprimer || $user-&gt;rights-&gt;supplier_invoice-&gt;supprimer);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    $uploaddir = $conf-&gt;fournisseur-&gt;facture-&gt;dir_output;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/actions_massactions.inc.php&#39;</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> ($massaction == <span class="stringliteral">&#39;banktransfertrequest&#39;</span>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        $langs-&gt;load(<span class="stringliteral">&quot;withdrawals&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (!$user-&gt;rights-&gt;paymentbybanktransfer-&gt;create) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            $error++;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($langs-&gt;trans(<span class="stringliteral">&quot;NotEnoughPermissions&quot;</span>), <span class="keyword">null</span>, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">//Checking error</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            $error = 0;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            $arrayofselected = is_array($toselect) ? $toselect : array();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            $listofbills = array();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">foreach</span> ($arrayofselected as $toselectid) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                $objecttmp = <span class="keyword">new</span> <a class="code" href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a>($db);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                $result = $objecttmp-&gt;fetch($toselectid);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span> ($result &gt; 0) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    $totalpaye = $objecttmp-&gt;getSommePaiement();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    $totalcreditnotes = $objecttmp-&gt;getSumCreditNotesUsed();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    $totaldeposits = $objecttmp-&gt;getSumDepositsUsed();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    $objecttmp-&gt;resteapayer = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a34644574d03047e0104710288a28ac91">price2num</a>($objecttmp-&gt;total_ttc - $totalpaye - $totalcreditnotes - $totaldeposits, <span class="stringliteral">&#39;MT&#39;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">if</span> ($objecttmp-&gt;statut == <a class="code" href="../../df/d8a/class_facture_fournisseur.html#ac39e16e98e33ffb1fae8298df5a20383">FactureFournisseur::STATUS_DRAFT</a>) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        $error++;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($objecttmp-&gt;ref.<span class="charliteral">&#39; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;Draft&quot;</span>), $objecttmp-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    } elseif ($objecttmp-&gt;paye || $objecttmp-&gt;resteapayer == 0) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        $error++;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($objecttmp-&gt;ref.<span class="charliteral">&#39; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;AlreadyPaid&quot;</span>), $objecttmp-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    } elseif ($objecttmp-&gt;resteapayer &lt; 0) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        $error++;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($objecttmp-&gt;ref.<span class="charliteral">&#39; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;AmountMustBePositive&quot;</span>), $objecttmp-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    $rsql = <span class="stringliteral">&quot;SELECT pfd.rowid, pfd.traite, pfd.date_demande as date_demande&quot;</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    $rsql .= <span class="stringliteral">&quot; , pfd.date_traite as date_traite&quot;</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    $rsql .= <span class="stringliteral">&quot; , pfd.amount&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    $rsql .= <span class="stringliteral">&quot; , u.rowid as user_id, u.lastname, u.firstname, u.login&quot;</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    $rsql .= <span class="stringliteral">&quot; FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;prelevement_facture_demande as pfd&quot;</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    $rsql .= <span class="stringliteral">&quot; , &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;user as u&quot;</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    $rsql .= <span class="stringliteral">&quot; WHERE fk_facture_fourn = &quot;</span>.((int) $objecttmp-&gt;id);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    $rsql .= <span class="stringliteral">&quot; AND pfd.fk_user_demande = u.rowid&quot;</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    $rsql .= <span class="stringliteral">&quot; AND pfd.traite = 0&quot;</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    $rsql .= <span class="stringliteral">&quot; ORDER BY pfd.date_demande DESC&quot;</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    $result_sql = $db-&gt;query($rsql);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">if</span> ($result_sql) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        $numprlv = $db-&gt;num_rows($result_sql);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <span class="keywordflow">if</span> ($numprlv &gt; 0) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        $error++;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($objecttmp-&gt;ref.<span class="charliteral">&#39; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;RequestAlreadyDone&quot;</span>), $objecttmp-&gt;errors, <span class="stringliteral">&#39;warnings&#39;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    } elseif (!empty($objecttmp-&gt;mode_reglement_code) &amp;&amp; $objecttmp-&gt;mode_reglement_code != <span class="stringliteral">&#39;VIR&#39;</span>) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        $error++;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($objecttmp-&gt;ref.<span class="charliteral">&#39; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;BadPaymentMethod&quot;</span>), $objecttmp-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        $listofbills[] = $objecttmp; <span class="comment">// $listofbills will only contains invoices with good payment method and no request already done</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">// Massive withdraw request for request with no errors</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">if</span> (!empty($listofbills)) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                $nbwithdrawrequestok = 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="keywordflow">foreach</span> ($listofbills as $aBill) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    $db-&gt;begin();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    $result = $aBill-&gt;demande_prelevement($user, $aBill-&gt;resteapayer, <span class="stringliteral">&#39;bank-transfer&#39;</span>, <span class="stringliteral">&#39;supplier_invoice&#39;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="keywordflow">if</span> ($result &gt; 0) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        $db-&gt;commit();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        $nbwithdrawrequestok++;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        $db-&gt;rollback();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($aBill-&gt;error, $aBill-&gt;errors, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">if</span> ($nbwithdrawrequestok &gt; 0) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a>($langs-&gt;trans(<span class="stringliteral">&quot;WithdrawRequestsDone&quot;</span>, $nbwithdrawrequestok), <span class="keyword">null</span>, <span class="stringliteral">&#39;mesgs&#39;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> * View</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;$form = <span class="keyword">new</span> <a class="code" href="../../df/d08/class_form.html">Form</a>($db);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;$formother = <span class="keyword">new</span> <a class="code" href="../../d0/dbd/class_form_other.html">FormOther</a>($db);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;$formfile = <span class="keyword">new</span> <a class="code" href="../../de/d23/class_form_file.html">FormFile</a>($db);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;$bankaccountstatic = <span class="keyword">new</span> <a class="code" href="../../db/d22/class_account.html">Account</a>($db);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;$facturestatic = <span class="keyword">new</span> <a class="code" href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a>($db);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;$formcompany = <span class="keyword">new</span> <a class="code" href="../../d2/d52/class_form_company.html">FormCompany</a>($db);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;$thirdparty = <span class="keyword">new</span> <a class="code" href="../../dc/dbc/class_societe.html">Societe</a>($db);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">// llxHeader(&#39;&#39;,$langs-&gt;trans(&quot;SuppliersInvoices&quot;),&#39;EN:Suppliers_Invoices|FR:FactureFournisseur|ES:Facturas_de_proveedores&#39;);</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;$sql = <span class="stringliteral">&quot;SELECT&quot;</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordflow">if</span> ($search_all || $search_product_category &gt; 0) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    $sql = <span class="stringliteral">&#39;SELECT DISTINCT&#39;</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;$sql .= <span class="stringliteral">&quot; f.rowid as facid, f.ref, f.ref_supplier, f.type, f.datef, f.date_lim_reglement as datelimite, f.fk_mode_reglement, f.fk_cond_reglement,&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;$sql .= <span class="stringliteral">&quot; f.total_ht, f.total_ttc, f.total_tva as total_vat, f.paye as paye, f.fk_statut as fk_statut, f.libelle as label, f.datec as date_creation, f.tms as date_update,&quot;</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;$sql .= <span class="stringliteral">&quot; f.localtax1 as total_localtax1, f.localtax2 as total_localtax2,&quot;</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;$sql .= <span class="stringliteral">&#39; f.fk_multicurrency, f.multicurrency_code, f.multicurrency_tx, f.multicurrency_total_ht, f.multicurrency_total_tva as multicurrency_total_vat, f.multicurrency_total_ttc,&#39;</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;$sql .= <span class="stringliteral">&quot; f.note_public, f.note_private,&quot;</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;$sql .= <span class="stringliteral">&quot; f.fk_user_author,&quot;</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;$sql .= <span class="stringliteral">&quot; s.rowid as socid, s.nom as name, s.email, s.town, s.zip, s.fk_pays, s.client, s.fournisseur, s.code_client, s.code_fournisseur, s.code_compta as code_compta_client, s.code_compta_fournisseur,&quot;</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;$sql .= <span class="stringliteral">&quot; typent.code as typent_code,&quot;</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;$sql .= <span class="stringliteral">&quot; state.code_departement as state_code, state.nom as state_name,&quot;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;$sql .= <span class="stringliteral">&quot; country.code as country_code,&quot;</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;$sql .= <span class="stringliteral">&quot; p.rowid as project_id, p.ref as project_ref, p.title as project_label,&quot;</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;$sql .= <span class="stringliteral">&#39; u.login, u.lastname, u.firstname, u.email as user_email, u.statut as user_statut, u.entity, u.photo, u.office_phone, u.office_fax, u.user_mobile, u.job, u.gender&#39;</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">if</span> ($search_categ_sup &amp;&amp; $search_categ_sup != <span class="stringliteral">&#39;-1&#39;</span>) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    $sql .= <span class="stringliteral">&quot;, cs.fk_categorie, cs.fk_soc&quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">// We need dynamount_payed to be able to sort on status (value is surely wrong because we can count several lines several times due to other left join or link with contacts. But what we need is just 0 or &gt; 0)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">// TODO Better solution to be able to sort on already payed or remain to pay is to store amount_payed in a denormalized field.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">if</span> (!$search_all) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    $sql .= <span class="stringliteral">&#39;, SUM(pf.amount) as dynamount_payed&#39;</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">// Add fields from extrafields</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">if</span> (!empty($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>])) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">foreach</span> ($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>] as $key =&gt; $val) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        $sql .= ($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;type&#39;</span>][$key] != <span class="stringliteral">&#39;separate&#39;</span> ? <span class="stringliteral">&quot;, ef.&quot;</span>.$key.<span class="stringliteral">&quot; as options_&quot;</span>.$key : <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">// Add fields from hooks</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;$parameters = array();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;$reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListSelect&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;$sql .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;$sql .= <span class="stringliteral">&#39; FROM &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;societe as s&#39;</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;$sql .= <span class="stringliteral">&quot; LEFT JOIN &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;c_country as country on (country.rowid = s.fk_pays)&quot;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;$sql .= <span class="stringliteral">&quot; LEFT JOIN &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;c_typent as typent on (typent.id = s.fk_typent)&quot;</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;$sql .= <span class="stringliteral">&quot; LEFT JOIN &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;c_departements as state on (state.rowid = s.fk_departement)&quot;</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">if</span> (!empty($search_categ_sup) &amp;&amp; $search_categ_supplier != <span class="stringliteral">&#39;-1&#39;</span>) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    $sql .= <span class="stringliteral">&#39; LEFT JOIN &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;categorie_fournisseur as cs ON s.rowid = cs.fk_soc&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;$sql .= <span class="stringliteral">&#39;, &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;facture_fourn as f&#39;</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">if</span> (is_array($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>]) &amp;&amp; count($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>])) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    $sql .= <span class="stringliteral">&quot; LEFT JOIN &quot;</span>.MAIN_DB_PREFIX.$object-&gt;table_element.<span class="stringliteral">&quot;_extrafields as ef on (f.rowid = ef.fk_object)&quot;</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordflow">if</span> (!$search_all) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    $sql .= <span class="stringliteral">&#39; LEFT JOIN &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;paiementfourn_facturefourn as pf ON pf.fk_facturefourn = f.rowid&#39;</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">if</span> ($search_all || $search_product_category &gt; 0) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    $sql .= <span class="stringliteral">&#39; LEFT JOIN &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;facture_fourn_det as pd ON f.rowid=pd.fk_facture_fourn&#39;</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">if</span> ($search_product_category &gt; 0) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    $sql .= <span class="stringliteral">&#39; LEFT JOIN &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;categorie_product as cp ON cp.fk_product=pd.fk_product&#39;</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;$sql .= <span class="stringliteral">&#39; LEFT JOIN &#39;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&#39;user AS u ON f.fk_user_author = u.rowid&#39;</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;$sql .= <span class="stringliteral">&quot; LEFT JOIN &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;projet as p ON p.rowid = f.fk_projet&quot;</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// We&#39;ll need this table joined to the select in order to filter by sale</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">if</span> ($search_sale &gt; 0 || (!$user-&gt;rights-&gt;societe-&gt;client-&gt;voir &amp;&amp; !$socid)) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    $sql .= <span class="stringliteral">&quot;, &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;societe_commerciaux as sc&quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordflow">if</span> ($search_user &gt; 0) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    $sql .= <span class="stringliteral">&quot;, &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;element_contact as ec&quot;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    $sql .= <span class="stringliteral">&quot;, &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;c_type_contact as tc&quot;</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">// Add table from hooks</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;$parameters = array();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;$reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListFrom&#39;</span>, $parameters, $object); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;$sql .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;$sql .= <span class="stringliteral">&#39; WHERE f.fk_soc = s.rowid&#39;</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;$sql .= <span class="stringliteral">&#39; AND f.entity IN (&#39;</span>.getEntity(<span class="stringliteral">&#39;facture_fourn&#39;</span>).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">if</span> (!$user-&gt;rights-&gt;societe-&gt;client-&gt;voir &amp;&amp; !$socid) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    $sql .= <span class="stringliteral">&quot; AND s.rowid = sc.fk_soc AND sc.fk_user = &quot;</span>.((int) $user-&gt;id);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">if</span> ($search_product_category &gt; 0) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    $sql .= <span class="stringliteral">&quot; AND cp.fk_categorie = &quot;</span>.((int) $search_product_category);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordflow">if</span> ($socid &gt; 0) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    $sql .= <span class="stringliteral">&#39; AND s.rowid = &#39;</span>.((int) $socid);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">if</span> ($search_ref) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (is_numeric($search_ref)) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(array(<span class="stringliteral">&#39;f.ref&#39;</span>), $search_ref);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.ref&#39;</span>, $search_ref);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">if</span> ($search_ref) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.ref&#39;</span>, $search_ref);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">if</span> ($search_refsupplier) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.ref_supplier&#39;</span>, $search_refsupplier);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordflow">if</span> ($search_type != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $search_type &gt;= 0) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> ($search_type == <span class="charliteral">&#39;0&#39;</span>) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        $sql .= <span class="stringliteral">&quot; AND f.type = 0&quot;</span>; <span class="comment">// standard</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> ($search_type == <span class="charliteral">&#39;1&#39;</span>) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        $sql .= <span class="stringliteral">&quot; AND f.type = 1&quot;</span>; <span class="comment">// replacement</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> ($search_type == <span class="charliteral">&#39;2&#39;</span>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        $sql .= <span class="stringliteral">&quot; AND f.type = 2&quot;</span>; <span class="comment">// credit note</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> ($search_type == <span class="charliteral">&#39;3&#39;</span>) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        $sql .= <span class="stringliteral">&quot; AND f.type = 3&quot;</span>; <span class="comment">// deposit</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">//if ($search_type == &#39;4&#39;) $sql.=&quot; AND f.type = 4&quot;;  // proforma</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">//if ($search_type == &#39;5&#39;) $sql.=&quot; AND f.type = 5&quot;;  // situation</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">if</span> ($search_project) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;p.ref&#39;</span>, $search_project);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keywordflow">if</span> ($search_company) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;s.nom&#39;</span>, $search_company);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordflow">if</span> ($search_town) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;s.town&#39;</span>, $search_town);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">if</span> ($search_zip) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&quot;s.zip&quot;</span>, $search_zip);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">if</span> ($search_state) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&quot;state.nom&quot;</span>, $search_state);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">if</span> ($search_country) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    $sql .= <span class="stringliteral">&quot; AND s.fk_pays IN (&quot;</span>.$db-&gt;sanitize($search_country).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">if</span> ($search_type_thirdparty != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $search_type_thirdparty &gt;= 0) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    $sql .= <span class="stringliteral">&quot; AND s.fk_typent IN (&quot;</span>.$db-&gt;sanitize($search_type_thirdparty).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">if</span> ($search_montant_ht != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.total_ht&#39;</span>, $search_montant_ht, 1);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordflow">if</span> ($search_montant_vat != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.total_tva&#39;</span>, $search_montant_vat, 1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordflow">if</span> ($search_montant_localtax1 != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.localtax1&#39;</span>, $search_montant_localtax1, 1);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;}</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">if</span> ($search_montant_localtax2 != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.localtax2&#39;</span>, $search_montant_localtax2, 1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">if</span> ($search_montant_ttc != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.total_ttc&#39;</span>, $search_montant_ttc, 1);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">if</span> ($search_multicurrency_code != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.multicurrency_code = &#39;&quot;</span>.$db-&gt;escape($search_multicurrency_code).<span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordflow">if</span> ($search_multicurrency_tx != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>, $search_multicurrency_tx, 1);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordflow">if</span> ($search_multicurrency_montant_ht != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>, $search_multicurrency_montant_ht, 1);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordflow">if</span> ($search_multicurrency_montant_vat != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.multicurrency_total_tva&#39;</span>, $search_multicurrency_montant_vat, 1);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">if</span> ($search_multicurrency_montant_ttc != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>, $search_multicurrency_montant_ttc, 1);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordflow">if</span> ($search_login) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;u.login&#39;</span>, $search_login);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">if</span> ($search_status != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $search_status &gt;= 0) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.fk_statut = &quot;</span>.((int) $search_status);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordflow">if</span> ($search_paymentmode &gt; 0) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.fk_mode_reglement = &quot;</span>.((int) $search_paymentmode);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordflow">if</span> ($search_paymentcond &gt; 0) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.fk_cond_reglement = &quot;</span>.((int) $search_paymentcond);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keywordflow">if</span> ($search_date_start) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.datef &gt;= &#39;&quot;</span> . $db-&gt;idate($search_date_start) . <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">if</span> ($search_date_end) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.datef &lt;= &#39;&quot;</span> . $db-&gt;idate($search_date_end) . <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">if</span> ($search_datelimit_start) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.date_lim_reglement &gt;= &#39;&quot;</span> . $db-&gt;idate($search_datelimit_start) . <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordflow">if</span> ($search_datelimit_end) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.date_lim_reglement &lt;= &#39;&quot;</span> . $db-&gt;idate($search_datelimit_end) . <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">if</span> ($option == <span class="stringliteral">&#39;late&#39;</span>) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.date_lim_reglement &lt; &#39;&quot;</span>.$db-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>() - $conf-&gt;facture-&gt;fournisseur-&gt;warning_delay).<span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">if</span> ($search_label) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(<span class="stringliteral">&#39;f.libelle&#39;</span>, $search_label);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">if</span> ($search_categ_sup &gt; 0) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    $sql .= <span class="stringliteral">&quot; AND cs.fk_categorie = &quot;</span>.((int) $search_categ_sup);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">if</span> ($search_categ_sup == -2) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    $sql .= <span class="stringliteral">&quot; AND cs.fk_categorie IS NULL&quot;</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">if</span> ($search_status != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $search_status &gt;= 0) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    $sql .= <span class="stringliteral">&quot; AND f.fk_statut = &quot;</span>.((int) $search_status);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">if</span> ($filter &amp;&amp; $filter != -1) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    $aFilter = explode(<span class="charliteral">&#39;,&#39;</span>, $filter);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">foreach</span> ($aFilter as $fil) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        $filt = explode(<span class="charliteral">&#39;:&#39;</span>, $fil);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        $sql .= <span class="stringliteral">&quot; AND &quot;</span>.$db-&gt;escape(trim($filt[0])).<span class="stringliteral">&quot; = &#39;&quot;</span>.$db-&gt;escape(trim($filt[1])).<span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keywordflow">if</span> ($search_sale &gt; 0) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    $sql .= <span class="stringliteral">&quot; AND s.rowid = sc.fk_soc AND sc.fk_user = &quot;</span>.((int) $search_sale);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">if</span> ($search_user &gt; 0) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    $sql .= <span class="stringliteral">&quot; AND ec.fk_c_type_contact = tc.rowid AND tc.element=&#39;invoice_supplier&#39; AND tc.source=&#39;internal&#39; AND ec.element_id = f.rowid AND ec.fk_socpeople = &quot;</span>.((int) $search_user);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">// Add where from extra fields</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_search_sql.tpl.php&#39;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">// Add where from hooks</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;$parameters = array();</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;$reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListWhere&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;$sql .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keywordflow">if</span> (!$search_all) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    $sql .= <span class="stringliteral">&quot; GROUP BY f.rowid, f.ref, f.ref_supplier, f.type, f.datef, f.date_lim_reglement, f.fk_mode_reglement, f.fk_cond_reglement,&quot;</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    $sql .= <span class="stringliteral">&quot; f.total_ht, f.total_ttc, f.total_tva, f.paye, f.fk_statut, f.libelle, f.datec, f.tms,&quot;</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    $sql .= <span class="stringliteral">&quot; f.localtax1, f.localtax2,&quot;</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    $sql .= <span class="stringliteral">&#39; f.fk_multicurrency, f.multicurrency_code, f.multicurrency_tx, f.multicurrency_total_ht, f.multicurrency_total_tva, f.multicurrency_total_ttc,&#39;</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    $sql .= <span class="stringliteral">&quot; f.note_public, f.note_private,&quot;</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    $sql .= <span class="stringliteral">&quot; f.fk_user_author,&quot;</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    $sql .= <span class="stringliteral">&#39; s.rowid, s.nom, s.email, s.town, s.zip, s.fk_pays, s.client, s.fournisseur, s.code_client, s.code_fournisseur, s.code_compta, s.code_compta_fournisseur,&#39;</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    $sql .= <span class="stringliteral">&quot; typent.code,&quot;</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    $sql .= <span class="stringliteral">&quot; state.code_departement, state.nom,&quot;</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    $sql .= <span class="stringliteral">&#39; country.code,&#39;</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    $sql .= <span class="stringliteral">&quot; p.rowid, p.ref, p.title,&quot;</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    $sql .= <span class="stringliteral">&quot; u.login, u.lastname, u.firstname, u.email, u.statut, u.entity, u.photo, u.office_phone, u.office_fax, u.user_mobile, u.job, u.gender&quot;</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">if</span> ($search_categ_sup &amp;&amp; $search_categ_sup != <span class="stringliteral">&#39;-1&#39;</span>) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        $sql .= <span class="stringliteral">&quot;, cs.fk_categorie, cs.fk_soc&quot;</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span> (!empty($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>])) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">foreach</span> ($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;label&#39;</span>] as $key =&gt; $val) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="comment">//prevent error with sql_mode=only_full_group_by</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            $sql .= ($extrafields-&gt;attributes[$object-&gt;table_element][<span class="stringliteral">&#39;type&#39;</span>][$key] != <span class="stringliteral">&#39;separate&#39;</span> ? <span class="stringliteral">&quot;,ef.&quot;</span>.$key : <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// Add GroupBy from hooks</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    $parameters = array(<span class="stringliteral">&#39;all&#39;</span> =&gt; $all, <span class="stringliteral">&#39;fieldstosearchall&#39;</span> =&gt; $fieldstosearchall);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListGroupBy&#39;</span>, $parameters, $object); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    $sql .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;} <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    $sql .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a>(array_keys($fieldstosearchall), $search_all);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">// Add HAVING from hooks</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;$parameters = array();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;$reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListHaving&#39;</span>, $parameters, $object); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;$sql .= !empty($hookmanager-&gt;resPrint) ? (<span class="stringliteral">&quot; HAVING 1=1 &quot;</span> . $hookmanager-&gt;resPrint) : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;$sql .= $db-&gt;order($sortfield, $sortorder);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;$nbtotalofrecords = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">if</span> (empty($conf-&gt;global-&gt;MAIN_DISABLE_FULL_SCANLIST)) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    $result = $db-&gt;query($sql);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    $nbtotalofrecords = $db-&gt;num_rows($result);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (($page * $limit) &gt; $nbtotalofrecords) { <span class="comment">// if total resultset is smaller then paging size (filtering), goto and load page 0</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        $page = 0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        $offset = 0;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;$sql .= $db-&gt;plimit($limit + 1, $offset);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//print $sql;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a> = $db-&gt;query($sql);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a>) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    $num = $db-&gt;num_rows(<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    $arrayofselected = is_array($toselect) ? $toselect : array();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> ($num == 1 &amp;&amp; !empty($conf-&gt;global-&gt;MAIN_SEARCH_DIRECT_OPEN_IF_ONLY_ONE) &amp;&amp; $sall) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        $obj = $db-&gt;fetch_object(<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        $id = $obj-&gt;facid;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        header(<span class="stringliteral">&quot;Location: &quot;</span>.DOL_URL_ROOT.<span class="stringliteral">&#39;/fourn/facture/card.php?facid=&#39;</span>.$id);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        exit;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="../../d6/d7c/asterisk_2wrapper_8php.html#abcab7df295b4869f8dfb1dd7059fd974">llxHeader</a>(<span class="stringliteral">&#39;&#39;</span>, $langs-&gt;trans(<span class="stringliteral">&quot;SuppliersInvoices&quot;</span>), <span class="stringliteral">&#39;EN:Suppliers_Invoices|FR:FactureFournisseur|ES:Facturas_de_proveedores&#39;</span>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> ($socid) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        $soc = <span class="keyword">new</span> <a class="code" href="../../dc/dbc/class_societe.html">Societe</a>($db);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        $soc-&gt;fetch($socid);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">if</span> (empty($search_company)) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            $search_company = $soc-&gt;name;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    $param = <span class="stringliteral">&#39;&amp;socid=&#39;</span>.$socid;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (!empty($contextpage) &amp;&amp; $contextpage != $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>]) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;contextpage=&#39;</span>.urlencode($contextpage);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span> ($limit &gt; 0 &amp;&amp; $limit != $conf-&gt;liste_limit) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;limit=&#39;</span>.urlencode($limit);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> ($search_all) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_all=&#39;</span>.urlencode($search_all);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> ($search_date_startday) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_startday=&#39;</span>.urlencode($search_date_startday);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> ($search_date_startmonth) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_startmonth=&#39;</span>.urlencode($search_date_startmonth);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span> ($search_date_startyear) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_startyear=&#39;</span>.urlencode($search_date_startyear);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> ($search_date_endday) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_endday=&#39;</span>.urlencode($search_date_endday);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> ($search_date_endmonth) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_endmonth=&#39;</span>.urlencode($search_date_endmonth);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span> ($search_date_endyear) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_date_endyear=&#39;</span>.urlencode($search_date_endyear);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_startday) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_startday=&#39;</span>.urlencode($search_datelimit_startday);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_startmonth) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_startmonth=&#39;</span>.urlencode($search_datelimit_startmonth);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_startyear) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_startyear=&#39;</span>.urlencode($search_datelimit_startyear);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_endday) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_endday=&#39;</span>.urlencode($search_datelimit_endday);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_endmonth) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_endmonth=&#39;</span>.urlencode($search_datelimit_endmonth);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">if</span> ($search_datelimit_endyear) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_datelimit_endyear=&#39;</span>.urlencode($search_datelimit_endyear);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> ($search_ref) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_ref=&#39;</span>.urlencode($search_ref);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> ($search_refsupplier) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_refsupplier=&#39;</span>.urlencode($search_refsupplier);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">if</span> ($search_type != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_type=&#39;</span>.urlencode($search_type);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> ($search_label) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_label=&#39;</span>.urlencode($search_label);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">if</span> ($search_company) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_company=&#39;</span>.urlencode($search_company);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> ($search_login) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_login=&#39;</span>.urlencode($search_login);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> ($search_montant_ht != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_montant_ht=&#39;</span>.urlencode($search_montant_ht);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> ($search_montant_vat != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_montant_vat=&#39;</span>.urlencode($search_montant_vat);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> ($search_montant_localtax1 != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_montant_localtax1=&#39;</span>.urlencode($search_montant_localtax1);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> ($search_montant_localtax2 != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_montant_localtax2=&#39;</span>.urlencode($search_montant_localtax2);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> ($search_montant_ttc != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_montant_ttc=&#39;</span>.urlencode($search_montant_ttc);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> ($search_multicurrency_code != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_multicurrency_code=&#39;</span>.urlencode($search_multicurrency_code);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> ($search_multicurrency_tx != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_multicurrency_tx=&#39;</span>.urlencode($search_multicurrency_tx);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> ($search_multicurrency_montant_ht != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_multicurrency_montant_ht=&#39;</span>.urlencode($search_multicurrency_montant_ht);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span> ($search_multicurrency_montant_vat != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_multicurrency_montant_vat=&#39;</span>.urlencode($search_multicurrency_montant_vat);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">if</span> ($search_multicurrency_montant_ttc != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_multicurrency_montant_ttc=&#39;</span>.urlencode($search_multicurrency_montant_ttc);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> ($search_amount_no_tax) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_amount_no_tax=&#39;</span>.urlencode($search_amount_no_tax);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> ($search_amount_all_tax) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_amount_all_tax=&#39;</span>.urlencode($search_amount_all_tax);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> ($search_status &gt;= 0) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        $param .= <span class="stringliteral">&quot;&amp;search_status=&quot;</span>.urlencode($search_status);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> ($show_files) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;show_files=&#39;</span>.urlencode($show_files);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span> ($option) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        $param .= <span class="stringliteral">&quot;&amp;search_option=&quot;</span>.urlencode($option);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">if</span> ($optioncss != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;optioncss=&#39;</span>.urlencode($optioncss);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> ($search_categ_sup &gt; 0) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_categ_sup=&#39;</span>.urlencode($search_categ_sup);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span> ($search_type_thirdparty != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $search_type_thirdparty &gt; 0) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        $param .= <span class="stringliteral">&#39;&amp;search_type_thirdparty=&#39;</span>.urlencode($search_type_thirdparty);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Add $param from extra fields</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_search_param.tpl.php&#39;</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// Add $param from hooks</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    $parameters = array();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListSearchParam&#39;</span>, $parameters, $object); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    $param .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// List of mass actions available</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    $arrayofmassactions = array(</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="stringliteral">&#39;validate&#39;</span>=&gt;<a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;check&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$langs-&gt;trans(<span class="stringliteral">&quot;Validate&quot;</span>),</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="stringliteral">&#39;generate_doc&#39;</span>=&gt;<a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;pdf&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$langs-&gt;trans(<span class="stringliteral">&quot;ReGeneratePDF&quot;</span>),</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">//&#39;builddoc&#39;=&gt;img_picto(&#39;&#39;, &#39;pdf&#39;, &#39;class=&quot;pictofixedwidth&quot;&#39;).$langs-&gt;trans(&quot;PDFMerge&quot;),</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="comment">//&#39;presend&#39;=&gt;img_picto(&#39;&#39;, &#39;email&#39;, &#39;class=&quot;pictofixedwidth&quot;&#39;).$langs-&gt;trans(&quot;SendByMail&quot;),</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    );</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">//if($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;creer) $arrayofmassactions[&#39;createbills&#39;]=$langs-&gt;trans(&quot;CreateInvoiceForThisCustomer&quot;);</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">if</span> (!empty($conf-&gt;paymentbybanktransfer-&gt;enabled) &amp;&amp; !empty($user-&gt;rights-&gt;paymentbybanktransfer-&gt;create)) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        $langs-&gt;load(<span class="stringliteral">&#39;withdrawals&#39;</span>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        $arrayofmassactions[<span class="stringliteral">&#39;banktransfertrequest&#39;</span>] = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;payment&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$langs-&gt;trans(<span class="stringliteral">&quot;MakeBankTransferOrder&quot;</span>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> ($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;supprimer) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        $arrayofmassactions[<span class="stringliteral">&#39;predelete&#39;</span>] = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;delete&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$langs-&gt;trans(<span class="stringliteral">&quot;Delete&quot;</span>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (in_array($massaction, array(<span class="stringliteral">&#39;presend&#39;</span>, <span class="stringliteral">&#39;predelete&#39;</span>, <span class="stringliteral">&#39;createbills&#39;</span>))) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        $arrayofmassactions = array();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    $massactionbutton = $form-&gt;selectMassAction(<span class="stringliteral">&#39;&#39;</span>, $arrayofmassactions);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    $url = DOL_URL_ROOT.<span class="stringliteral">&#39;/fourn/facture/card.php?action=create&#39;</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (!empty($socid)) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        $url .= <span class="stringliteral">&#39;&amp;socid=&#39;</span>.urlencode($socid);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    $newcardbutton = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a4807115abf884f121a03c282fd032">dolGetButtonTitle</a>($langs-&gt;trans(<span class="stringliteral">&#39;NewBill&#39;</span>), <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;fa fa-plus-circle&#39;</span>, $url, <span class="stringliteral">&#39;&#39;</span>, ($user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;creer || $user-&gt;rights-&gt;supplier_invoice-&gt;creer));</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    $i = 0;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    print <span class="stringliteral">&#39;&lt;form method=&quot;POST&quot; name=&quot;searchFormList&quot; action=&quot;&#39;</span>.$_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>].<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span> ($optioncss != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;optioncss&quot; value=&quot;&#39;</span>.$optioncss.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;&#39;</span>.newToken().<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;formfilteraction&quot; id=&quot;formfilteraction&quot; value=&quot;list&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;list&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;sortfield&quot; value=&quot;&#39;</span>.$sortfield.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;sortorder&quot; value=&quot;&#39;</span>.$sortorder.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;socid&quot; value=&quot;&#39;</span>.$socid.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../d9/d69/functions_8lib_8php.html#aabdd318c9960cbb2e505161e64eace1c">print_barre_liste</a>($langs-&gt;trans(<span class="stringliteral">&quot;BillsSuppliers&quot;</span>).($socid ? <span class="charliteral">&#39; &#39;</span>.$soc-&gt;name : <span class="stringliteral">&#39;&#39;</span>), $page, $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], $param, $sortfield, $sortorder, $massactionbutton, $num, $nbtotalofrecords, <span class="stringliteral">&#39;supplier_invoice&#39;</span>, 0, $newcardbutton, <span class="stringliteral">&#39;&#39;</span>, $limit, 0, 0, 1);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    $topicmail = <span class="stringliteral">&quot;SendBillRef&quot;</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    $modelmail = <span class="stringliteral">&quot;invoice_supplier_send&quot;</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    $objecttmp = <span class="keyword">new</span> <a class="code" href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a>($db);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    $trackid = <span class="stringliteral">&#39;sinv&#39;</span>.$object-&gt;id;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/massactions_pre.tpl.php&#39;</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> ($massaction == <span class="stringliteral">&#39;createbills&#39;</span>) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="comment">//var_dump($_REQUEST);</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        print <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;massaction&quot; value=&quot;confirm_createbills&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        print <span class="stringliteral">&#39;&lt;table class=&quot;border&quot; width=&quot;100%&quot; &gt;&#39;</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        print <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;titlefieldmiddle&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        print $langs-&gt;trans(<span class="stringliteral">&#39;DateInvoice&#39;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        print <span class="stringliteral">&#39;&lt;td&gt;&#39;</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        print $form-&gt;selectDate(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1, 1);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        print <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        print <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        print <span class="stringliteral">&#39;&lt;td&gt;&#39;</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        print $langs-&gt;trans(<span class="stringliteral">&#39;CreateOneBillByThird&#39;</span>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        print <span class="stringliteral">&#39;&lt;td&gt;&#39;</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        print $form-&gt;selectyesno(<span class="stringliteral">&#39;createbills_onebythird&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        print <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        print <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        print <span class="stringliteral">&#39;&lt;td&gt;&#39;</span>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        print $langs-&gt;trans(<span class="stringliteral">&#39;ValidateInvoices&#39;</span>);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        print <span class="stringliteral">&#39;&lt;td&gt;&#39;</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        print $form-&gt;selectyesno(<span class="stringliteral">&#39;validate_invoices&#39;</span>, 1, 1);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        print <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        print <span class="stringliteral">&#39;&lt;/table&gt;&#39;</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        print <span class="stringliteral">&#39;&lt;br&gt;&#39;</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        print <span class="stringliteral">&#39;&lt;input type=&quot;submit&quot; class=&quot;button&quot; id=&quot;createbills&quot; name=&quot;createbills&quot; value=&quot;&#39;</span>.$langs-&gt;trans(<span class="stringliteral">&#39;CreateInvoiceForThisCustomer&#39;</span>).<span class="stringliteral">&#39;&quot;&gt;  &#39;</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        print <span class="stringliteral">&#39;&lt;input type=&quot;submit&quot; class=&quot;button button-cancel&quot; id=&quot;cancel&quot; name=&quot;cancel&quot; value=&quot;&#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;Cancel&quot;</span>).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        print <span class="stringliteral">&#39;&lt;br&gt;&#39;</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> ($search_all) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">foreach</span> ($fieldstosearchall as $key =&gt; $val) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            $fieldstosearchall[$key] = $langs-&gt;trans($val);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;divsearchfieldfilter&quot;&gt;&#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;FilterOnInto&quot;</span>, $search_all).join(<span class="stringliteral">&#39;, &#39;</span>, $fieldstosearchall).<span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// If the user can view prospects other than his&#39;</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    $moreforfilter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> ($user-&gt;rights-&gt;societe-&gt;client-&gt;voir || $socid) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        $langs-&gt;load(<span class="stringliteral">&quot;commercial&quot;</span>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;div class=&quot;divsearchfield&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        $tmptitle = $langs-&gt;trans(<span class="stringliteral">&#39;ThirdPartiesOfSaleRepresentative&#39;</span>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        $moreforfilter .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>($tmptitle, <span class="stringliteral">&#39;company&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$formother-&gt;select_salesrepresentatives($search_sale, <span class="stringliteral">&#39;search_sale&#39;</span>, $user, 0, $tmptitle, <span class="stringliteral">&#39;maxwidth200&#39;</span>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// If the user can view prospects other than his&#39;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> ($user-&gt;rights-&gt;societe-&gt;client-&gt;voir || $socid) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;div class=&quot;divsearchfield&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        $tmptitle = $langs-&gt;trans(<span class="stringliteral">&#39;LinkedToSpecificUsers&#39;</span>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        $moreforfilter .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>($tmptitle, <span class="stringliteral">&#39;user&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$form-&gt;select_dolusers($search_user, <span class="stringliteral">&#39;search_user&#39;</span>, $tmptitle, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;maxwidth200&#39;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// If the user can view prospects other than his&#39;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (!empty($conf-&gt;categorie-&gt;enabled) &amp;&amp; $user-&gt;rights-&gt;categorie-&gt;lire &amp;&amp; ($user-&gt;rights-&gt;produit-&gt;lire || $user-&gt;rights-&gt;service-&gt;lire)) {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        include_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/categories/class/categorie.class.php&#39;</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;div class=&quot;divsearchfield&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        $tmptitle = $langs-&gt;trans(<span class="stringliteral">&#39;IncludingProductWithTag&#39;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        $cate_arbo = $form-&gt;select_all_categories(Categorie::TYPE_PRODUCT, <span class="keyword">null</span>, <span class="stringliteral">&#39;parent&#39;</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, 1);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        $moreforfilter .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>($tmptitle, <span class="stringliteral">&#39;category&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$form-&gt;selectarray(<span class="stringliteral">&#39;search_product_category&#39;</span>, $cate_arbo, $search_product_category, $tmptitle, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, 0, 0, 0, <span class="stringliteral">&#39;maxwidth300&#39;</span>, 1);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">if</span> (!empty($conf-&gt;categorie-&gt;enabled)) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        require_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/categories/class/categorie.class.php&#39;</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;div class=&quot;divsearchfield&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        $tmptitle = $langs-&gt;trans(<span class="stringliteral">&#39;SuppliersCategoriesShort&#39;</span>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        $moreforfilter .= <a class="code" href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a>($tmptitle, <span class="stringliteral">&#39;category&#39;</span>, <span class="stringliteral">&#39;class=&quot;pictofixedwidth&quot;&#39;</span>).$formother-&gt;select_categories(<span class="stringliteral">&#39;supplier&#39;</span>, $search_categ_sup, <span class="stringliteral">&#39;search_categ_sup&#39;</span>, 1, $tmptitle);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        $moreforfilter .= <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    $parameters = array();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldPreListTitle&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span> (empty($reshook)) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        $moreforfilter .= $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        $moreforfilter = $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">if</span> ($moreforfilter) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;liste_titre liste_titre_bydiv centpercent&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        print $moreforfilter;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    $varpage = empty($contextpage) ? $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>] : $contextpage;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    $selectedfields = $form-&gt;multiSelectArrayWithCheckbox(<span class="stringliteral">&#39;selectedfields&#39;</span>, $arrayfields, $varpage); <span class="comment">// This also change content of $arrayfields</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span> ($massactionbutton) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        $selectedfields .= $form-&gt;showCheckAddButtons(<span class="stringliteral">&#39;checkforselect&#39;</span>, 1);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    print <span class="stringliteral">&#39;&lt;div class=&quot;div-table-responsive&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    print <span class="stringliteral">&#39;&lt;table class=&quot;tagtable liste&#39;</span>.($moreforfilter ? <span class="stringliteral">&quot; listwithfilterbefore&quot;</span> : <span class="stringliteral">&quot;&quot;</span>).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// Line for filters</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    print <span class="stringliteral">&#39;&lt;tr class=&quot;liste_titre_filter&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="comment">// Ref</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre left&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_ref&quot; value=&quot;&#39;</span>.$search_ref.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// Ref supplier</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref_supplier&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_refsupplier&quot; value=&quot;&#39;</span>.$search_refsupplier.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// Type</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.type&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre maxwidthonsmartphone&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        $listtype = array(</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <a class="code" href="../../df/d8a/class_facture_fournisseur.html#a7f4ad3d12b7cf8b15d466a81da201e2d">FactureFournisseur::TYPE_STANDARD</a>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;InvoiceStandard&quot;</span>),</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <a class="code" href="../../df/d8a/class_facture_fournisseur.html#ad2fb708f4565e0c40e0a657508e4e9a1">FactureFournisseur::TYPE_REPLACEMENT</a>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;InvoiceReplacement&quot;</span>),</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                <a class="code" href="../../df/d8a/class_facture_fournisseur.html#ad94bc08e9cfeb9cd3d8a9b2343f306c7">FactureFournisseur::TYPE_CREDIT_NOTE</a>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;InvoiceAvoir&quot;</span>),</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <a class="code" href="../../df/d8a/class_facture_fournisseur.html#aee7d4c2527e22a8cad7d0bc1f77af318">FactureFournisseur::TYPE_DEPOSIT</a>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;InvoiceDeposit&quot;</span>),</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        );</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">        if (! empty($conf-&gt;global-&gt;INVOICE_USE_SITUATION))</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">            $listtype[Facture::TYPE_SITUATION] = $langs-&gt;trans(&quot;InvoiceSituation&quot;);</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">//$listtype[Facture::TYPE_PROFORMA]=$langs-&gt;trans(&quot;InvoiceProForma&quot;);     // A proformat invoice is not an invoice but must be an order.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        print $form-&gt;selectarray(<span class="stringliteral">&#39;search_type&#39;</span>, $listtype, $search_type, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, 0, 0, <span class="stringliteral">&#39;ASC&#39;</span>, <span class="stringliteral">&#39;maxwidth100&#39;</span>);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">// Label</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.label&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat maxwidth75&quot; type=&quot;text&quot; name=&quot;search_label&quot; value=&quot;&#39;</span>.$search_label.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// Date invoice</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datef&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        print $form-&gt;selectDate($search_date_start ? $search_date_start : -1, <span class="stringliteral">&#39;search_date_start&#39;</span>, 0, 0, 1, <span class="stringliteral">&#39;&#39;</span>, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1, <span class="stringliteral">&#39;&#39;</span>, $langs-&gt;trans(<span class="stringliteral">&#39;From&#39;</span>));</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        print $form-&gt;selectDate($search_date_end ? $search_date_end : -1, <span class="stringliteral">&#39;search_date_end&#39;</span>, 0, 0, 1, <span class="stringliteral">&#39;&#39;</span>, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1, <span class="stringliteral">&#39;&#39;</span>, $langs-&gt;trans(<span class="stringliteral">&#39;to&#39;</span>));</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// Date due</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.date_lim_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        print <span class="stringliteral">&#39;&lt;div class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">        print $langs-&gt;trans(&#39;From&#39;).&#39; &#39;;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">        print $form-&gt;selectDate($search_datelimit_start ? $search_datelimit_start : -1, &#39;search_datelimit_start&#39;, 0, 0, 1);</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">        print &#39;&lt;/div&gt;&#39;;</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">        print &#39;&lt;div class=&quot;nowrap&quot;&gt;&#39;;</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">        print $langs-&gt;trans(&#39;to&#39;).&#39; &#39;;*/</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        print $form-&gt;selectDate($search_datelimit_end ? $search_datelimit_end : -1, <span class="stringliteral">&#39;search_datelimit_end&#39;</span>, 0, 0, 1, <span class="stringliteral">&#39;&#39;</span>, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1, <span class="stringliteral">&#39;&#39;</span>, $langs-&gt;trans(<span class="stringliteral">&quot;Before&quot;</span>));</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        print <span class="stringliteral">&#39;&lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;search_option&quot; value=&quot;late&quot;&#39;</span>.($option == <span class="stringliteral">&#39;late&#39;</span> ? <span class="stringliteral">&#39; checked&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).<span class="stringliteral">&#39;&gt; &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&quot;Alert&quot;</span>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// Project</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;p.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_project&quot; value=&quot;&#39;</span>.$search_project.<span class="stringliteral">&#39;&quot;&gt;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">// Thirpdarty</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_company&quot; value=&quot;&#39;</span>.$search_company.<span class="stringliteral">&#39;&quot;&gt;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// Town</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.town&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_town&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_town).<span class="stringliteral">&#39;&quot;&gt;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">// Zip</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.zip&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre center&quot;&gt;&lt;input class=&quot;flat maxwidth50&quot; type=&quot;text&quot; name=&quot;search_zip&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_zip).<span class="stringliteral">&#39;&quot;&gt;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// State</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;state.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; size=&quot;4&quot; type=&quot;text&quot; name=&quot;search_state&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_state).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">// Country</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;country.code_iso&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        print $form-&gt;select_country($search_country, <span class="stringliteral">&#39;search_country&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;minwidth100imp maxwidth100&#39;</span>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">// Company type</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;typent.code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre maxwidthonsmartphone center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        print $form-&gt;selectarray(<span class="stringliteral">&quot;search_type_thirdparty&quot;</span>, $formcompany-&gt;typent_array(0), $search_type_thirdparty, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, 0, 0, (empty($conf-&gt;global-&gt;SOCIETE_SORT_ON_TYPEENT) ? <span class="stringliteral">&#39;ASC&#39;</span> : $conf-&gt;global-&gt;SOCIETE_SORT_ON_TYPEENT), <span class="stringliteral">&#39;&#39;</span>, 1);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// Condition of payment</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_cond_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre left&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        $form-&gt;select_conditions_paiements($search_paymentcond, <span class="stringliteral">&#39;search_paymentcond&#39;</span>, -1, 1, 1, <span class="stringliteral">&#39;maxwidth100&#39;</span>);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// Payment mode</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_mode_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre left&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        $form-&gt;select_types_paiements($search_paymentmode, <span class="stringliteral">&#39;search_paymentmode&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 1, 1, 20, 1, <span class="stringliteral">&#39;maxwidth100&#39;</span>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="comment">// Amount without tax</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;5&quot; name=&quot;search_montant_ht&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_montant_ht).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">// Amount vat</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;5&quot; name=&quot;search_montant_vat&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_montant_vat).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax1&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="comment">// Amount tax 1</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;5&quot; name=&quot;search_montant_localtax1&quot; value=&quot;&#39;</span>.$search_montant_localtax1.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax2&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">// Amount tax 2</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;5&quot; name=&quot;search_montant_localtax2&quot; value=&quot;&#39;</span>.$search_montant_localtax2.<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">// Amount inc tac</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;5&quot; name=&quot;search_montant_ttc&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_montant_ttc).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;u.login&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">// Author</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot; align=&quot;center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; size=&quot;4&quot; type=&quot;text&quot; name=&quot;search_login&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_login).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">// Currency</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        print $form-&gt;selectMultiCurrency($search_multicurrency_code, <span class="stringliteral">&#39;search_multicurrency_code&#39;</span>, 1);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="comment">// Currency rate</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;4&quot; name=&quot;search_multicurrency_tx&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_multicurrency_tx).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="comment">// Amount</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;4&quot; name=&quot;search_multicurrency_montant_ht&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_multicurrency_montant_ht).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="comment">// Amount</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;4&quot; name=&quot;search_multicurrency_montant_vat&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_multicurrency_montant_vat).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="comment">// Amount</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        print <span class="stringliteral">&#39;&lt;input class=&quot;flat&quot; type=&quot;text&quot; size=&quot;4&quot; name=&quot;search_multicurrency_montant_ttc&quot; value=&quot;&#39;</span>.dol_escape_htmltag($search_multicurrency_montant_ttc).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">// Extra fields</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_search_input.tpl.php&#39;</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">// Fields from hook</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    $parameters = array(<span class="stringliteral">&#39;arrayfields&#39;</span>=&gt;$arrayfields);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListOption&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    print $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// Date creation</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datec&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Date modification</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.tms&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">// Status</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_statut&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre maxwidthonsmartphone right&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        $liststatus = array(<span class="charliteral">&#39;0&#39;</span>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;Draft&quot;</span>), <span class="charliteral">&#39;1&#39;</span>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;Unpaid&quot;</span>), <span class="charliteral">&#39;2&#39;</span>=&gt;$langs-&gt;trans(<span class="stringliteral">&quot;Paid&quot;</span>));</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        print $form-&gt;selectarray(<span class="stringliteral">&#39;search_status&#39;</span>, $liststatus, $search_status, 1, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// Action column</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    print <span class="stringliteral">&#39;&lt;td class=&quot;liste_titre middle&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    $searchpicto = $form-&gt;showFilterButtons();</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    print $searchpicto;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    print <span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    print <span class="stringliteral">&#39;&lt;tr class=&quot;liste_titre&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.ref&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.ref,f.rowid&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref_supplier&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.ref_supplier&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&#39;f.ref_supplier&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.type&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.type&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&#39;f.type&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.label&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.label&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&quot;f.libelle,f.rowid&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datef&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.datef&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.datef,f.rowid&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center &#39;</span>);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.date_lim_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.date_lim_reglement&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&quot;f.date_lim_reglement&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center &#39;</span>);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;p.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;p.ref&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&quot;p.ref&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;s.nom&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;s.nom&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.town&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;s.town&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&#39;s.town&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.zip&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;s.zip&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&#39;s.zip&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center &#39;</span>);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;state.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;state.nom&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;state.nom&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;country.code_iso&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;country.code_iso&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;country.code_iso&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center &#39;</span>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;typent.code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;typent.code&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;typent.code&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center &#39;</span>);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_cond_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.fk_cond_reglement&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;f.fk_cond_reglement&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&quot;&quot;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_mode_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.fk_mode_reglement&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;f.fk_mode_reglement&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&quot;&quot;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.total_ht&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.total_ht&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.total_vat&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.total_tva&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax1&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.total_localtax1&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.localtax1&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax2&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.total_localtax2&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.localtax2&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.total_ttc&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.total_ttc&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;u.login&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;u.login&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&#39;u.login&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;align=&quot;center&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;dynamount_payed&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;rtp&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.multicurrency_code&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.multicurrency_code&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;class=&quot;right&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_vat&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.multicurrency_total_tva&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;class=&quot;right&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;class=&quot;right&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;multicurrency_dynamount_payed&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;class=&quot;right&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;multicurrency_rtp&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $param, <span class="stringliteral">&#39;class=&quot;right&quot;&#39;</span>, $sortfield, $sortorder);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">// Extra fields</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_search_title.tpl.php&#39;</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// Hook fields</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    $parameters = array(<span class="stringliteral">&#39;arrayfields&#39;</span>=&gt;$arrayfields, <span class="stringliteral">&#39;param&#39;</span>=&gt;$param, <span class="stringliteral">&#39;sortfield&#39;</span>=&gt;$sortfield, <span class="stringliteral">&#39;sortorder&#39;</span>=&gt;$sortorder);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListTitle&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    print $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datec&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.datec&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;f.datec&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center nowrap &#39;</span>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.tms&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.tms&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;f.tms&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center nowrap &#39;</span>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_statut&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($arrayfields[<span class="stringliteral">&#39;f.fk_statut&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>], $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;fk_statut,paye,type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $param, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;right &#39;</span>);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a>($selectedfields, $_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>], <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $sortfield, $sortorder, <span class="stringliteral">&#39;center maxwidthsearch &#39;</span>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    print <span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    $facturestatic = <span class="keyword">new</span> <a class="code" href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a>($db);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    $supplierstatic = <span class="keyword">new</span> <a class="code" href="../../de/d1a/class_fournisseur.html">Fournisseur</a>($db);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    $projectstatic = <span class="keyword">new</span> <a class="code" href="../../d9/d6e/class_project.html">Project</a>($db);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    $userstatic = <span class="keyword">new</span> <a class="code" href="../../d7/d23/class_user.html">User</a>($db);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> ($num &gt; 0) {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        $i = 0;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        $totalarray = array();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">while</span> ($i &lt; min($num, $limit)) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            $obj = $db-&gt;fetch_object(<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a>);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            $datelimit = $db-&gt;jdate($obj-&gt;datelimite);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            $facturestatic-&gt;id = $obj-&gt;facid;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            $facturestatic-&gt;ref = $obj-&gt;ref;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            $facturestatic-&gt;type = $obj-&gt;type;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            $facturestatic-&gt;ref_supplier = $obj-&gt;ref_supplier;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            $facturestatic-&gt;date_echeance = $db-&gt;jdate($obj-&gt;datelimite);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            $facturestatic-&gt;statut = $obj-&gt;fk_statut;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            $facturestatic-&gt;note_public = $obj-&gt;note_public;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            $facturestatic-&gt;note_private = $obj-&gt;note_private;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            $facturestatic-&gt;multicurrency_code = $obj-&gt;multicurrency_code;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            $facturestatic-&gt;multicurrency_tx = $obj-&gt;multicurrency_tx;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            $facturestatic-&gt;multicurrency_total_ht = $obj-&gt;multicurrency_total_ht;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            $facturestatic-&gt;multicurrency_total_tva = $obj-&gt;multicurrency_total_vat;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            $facturestatic-&gt;multicurrency_total_ttc = $obj-&gt;multicurrency_total_ttc;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            $thirdparty-&gt;id = $obj-&gt;socid;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            $thirdparty-&gt;name = $obj-&gt;name;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            $thirdparty-&gt;client = $obj-&gt;client;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            $thirdparty-&gt;fournisseur = $obj-&gt;fournisseur;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            $thirdparty-&gt;code_client = $obj-&gt;code_client;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            $thirdparty-&gt;code_compta_client = $obj-&gt;code_compta_client;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            $thirdparty-&gt;code_fournisseur = $obj-&gt;code_fournisseur;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            $thirdparty-&gt;code_compta_fournisseur = $obj-&gt;code_compta_fournisseur;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            $thirdparty-&gt;email = $obj-&gt;email;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            $thirdparty-&gt;country_code = $obj-&gt;country_code;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            $paiement = $facturestatic-&gt;getSommePaiement();</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            $totalcreditnotes = $facturestatic-&gt;getSumCreditNotesUsed();</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            $totaldeposits = $facturestatic-&gt;getSumDepositsUsed();</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            $totalpay = $paiement + $totalcreditnotes + $totaldeposits;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            $remaintopay = $obj-&gt;total_ttc - $totalpay;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            $multicurrency_paiement = $facturestatic-&gt;getSommePaiement(1);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            $multicurrency_totalcreditnotes = $facturestatic-&gt;getSumCreditNotesUsed(1);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            $multicurrency_totaldeposits = $facturestatic-&gt;getSumDepositsUsed(1);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            $multicurrency_totalpay = $multicurrency_paiement + $multicurrency_totalcreditnotes + $multicurrency_totaldeposits;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            $multicurrency_remaintopay = <a class="code" href="../../d9/d69/functions_8lib_8php.html#a34644574d03047e0104710288a28ac91">price2num</a>($facturestatic-&gt;multicurrency_total_ttc - $multicurrency_totalpay);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            $facturestatic-&gt;alreadypaid = ($paiement ? $paiement : 0);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            $facturestatic-&gt;paye = $obj-&gt;paye;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            $facturestatic-&gt;statut = $obj-&gt;fk_statut;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            $facturestatic-&gt;type = $obj-&gt;type;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="comment">//If invoice has been converted and the conversion has been used, we dont have remain to pay on invoice</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            <span class="keywordflow">if</span> ($facturestatic-&gt;type == <a class="code" href="../../df/d8a/class_facture_fournisseur.html#ad94bc08e9cfeb9cd3d8a9b2343f306c7">FactureFournisseur::TYPE_CREDIT_NOTE</a>) {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                <span class="keywordflow">if</span> ($facturestatic-&gt;isCreditNoteUsed()) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                    $remaintopay = -$facturestatic-&gt;getSumFromThisCreditNotesNotUsed();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            print <span class="stringliteral">&#39;&lt;tr class=&quot;oddeven&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                print <span class="stringliteral">&#39;&lt;table class=&quot;nobordernopadding&quot;&gt;&lt;tr class=&quot;nocellnopadd&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                <span class="comment">// Picto + Ref</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nobordernopadding nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                print $facturestatic-&gt;getNomUrl(1, <span class="stringliteral">&#39;&#39;</span>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, 0, -1, 1);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                $filename = <a class="code" href="../../d9/d69/functions_8lib_8php.html#ac3be82e6fd86f4f54522be5c5453b981">dol_sanitizeFileName</a>($obj-&gt;ref);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                $filedir = $conf-&gt;fournisseur-&gt;facture-&gt;dir_output.<span class="charliteral">&#39;/&#39;</span>.<a class="code" href="../../d9/d69/functions_8lib_8php.html#af47175099567f74f62e2e428ff8a26dd">get_exdir</a>($obj-&gt;facid, 2, 0, 0, $facturestatic, <span class="stringliteral">&#39;invoice_supplier&#39;</span>).dol_sanitizeFileName($obj-&gt;ref);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                $subdir = <a class="code" href="../../d9/d69/functions_8lib_8php.html#af47175099567f74f62e2e428ff8a26dd">get_exdir</a>($obj-&gt;facid, 2, 0, 0, $facturestatic, <span class="stringliteral">&#39;invoice_supplier&#39;</span>).dol_sanitizeFileName($obj-&gt;ref);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                print $formfile-&gt;getDocumentsLink(<span class="stringliteral">&#39;facture_fournisseur&#39;</span>, $subdir, $filedir);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                print <span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            <span class="comment">// Supplier ref</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.ref_supplier&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap tdoverflowmax150&quot; title=&quot;&#39;</span>.dol_escape_htmltag($obj-&gt;ref_supplier).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                print $obj-&gt;ref_supplier;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="comment">// Type</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.type&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                print $facturestatic-&gt;getLibType();</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                print <span class="stringliteral">&quot;&lt;/td&gt;&quot;</span>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            <span class="comment">// Label</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.label&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                print $obj-&gt;label;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="comment">// Date</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datef&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                print <a class="code" href="../../d9/d69/functions_8lib_8php.html#a52dc9c15ed0565a4b8312dc7d7d41fcb">dol_print_date</a>($db-&gt;jdate($obj-&gt;datef), <span class="stringliteral">&#39;day&#39;</span>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="comment">// Date limit</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.date_lim_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center nowraponall&quot;&gt;&#39;</span>.dol_print_date($datelimit, <span class="stringliteral">&#39;day&#39;</span>);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">if</span> ($facturestatic-&gt;hasDelay()) {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    print <a class="code" href="../../d9/d69/functions_8lib_8php.html#a1b743ba3487d5ca14c5f0a86a07edc71">img_warning</a>($langs-&gt;trans(<span class="stringliteral">&#39;Alert&#39;</span>).<span class="stringliteral">&#39; - &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&#39;Late&#39;</span>));</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="comment">// Project</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;p.ref&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                <span class="keywordflow">if</span> ($obj-&gt;project_id &gt; 0) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                    $projectstatic-&gt;id = $obj-&gt;project_id;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                    $projectstatic-&gt;ref = $obj-&gt;project_ref;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    $projectstatic-&gt;title = $obj-&gt;project_label;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    print $projectstatic-&gt;getNomUrl(1);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <span class="comment">// Third party</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;tdoverflowmax200&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                print $thirdparty-&gt;getNomUrl(1, <span class="stringliteral">&#39;supplier&#39;</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            <span class="comment">// Town</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.town&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nocellnopadd&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                print $obj-&gt;town;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="comment">// Zip</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;s.zip&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;nocellnopadd center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                print $obj-&gt;zip;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            <span class="comment">// State</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;state.nom&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                print <span class="stringliteral">&quot;&lt;td&gt;&quot;</span>.$obj-&gt;state_name.<span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            <span class="comment">// Country</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;country.code_iso&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                $tmparray = <a class="code" href="../../d5/d2b/company_8lib_8php.html#a73a2dc5e3c857a36bdcd0a9fcdc40933">getCountry</a>($obj-&gt;fk_pays, <span class="stringliteral">&#39;all&#39;</span>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                print $tmparray[<span class="stringliteral">&#39;label&#39;</span>];</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <span class="comment">// Type ent</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;typent.code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                <span class="keywordflow">if</span> (empty($typenArray)) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    $typenArray = $formcompany-&gt;typent_array(1);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                print $typenArray[$obj-&gt;typent_code];</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            <span class="comment">// Payment condition</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_cond_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;tdoverflowmax125&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                $form-&gt;form_conditions_reglement($_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], $obj-&gt;fk_cond_reglement, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, -1);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="comment">// Payment mode</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_mode_reglement&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;tdoverflowmax125&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                $form-&gt;form_modes_reglement($_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>], $obj-&gt;fk_mode_reglement, <span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, -1);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <span class="comment">// Amount HT</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                  print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;total_ht).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;f.total_ht&#39;</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                  $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;f.total_ht&#39;</span>] += $obj-&gt;total_ht;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="comment">// Amount VAT</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;total_vat).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;f.total_vat&#39;</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;f.total_vat&#39;</span>] += $obj-&gt;total_vat;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            }</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="comment">// Amount LocalTax1</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax1&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;total_localtax1).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;f.total_localtax1&#39;</span>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;f.total_localtax1&#39;</span>] += $obj-&gt;total_localtax1;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="comment">// Amount LocalTax2</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_localtax2&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;total_localtax2).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;f.total_localtax2&#39;</span>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;f.total_localtax2&#39;</span>] += $obj-&gt;total_localtax2;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="comment">// Amount TTC</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;total_ttc).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;f.total_ttc&#39;</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;f.total_ttc&#39;</span>] += $obj-&gt;total_ttc;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            $userstatic-&gt;id = $obj-&gt;fk_user_author;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            $userstatic-&gt;login = $obj-&gt;login;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            $userstatic-&gt;lastname = $obj-&gt;lastname;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            $userstatic-&gt;firstname = $obj-&gt;firstname;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            $userstatic-&gt;email = $obj-&gt;user_email;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            $userstatic-&gt;statut = $obj-&gt;user_statut;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            $userstatic-&gt;entity = $obj-&gt;entity;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            $userstatic-&gt;photo = $obj-&gt;photo;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            $userstatic-&gt;office_phone = $obj-&gt;office_phone;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            $userstatic-&gt;office_fax = $obj-&gt;office_fax;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            $userstatic-&gt;user_mobile = $obj-&gt;user_mobile;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            $userstatic-&gt;job = $obj-&gt;job;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            $userstatic-&gt;gender = $obj-&gt;gender;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <span class="comment">// Author</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;u.login&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;tdoverflowmax200&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                <span class="keywordflow">if</span> ($userstatic-&gt;id) {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    print $userstatic-&gt;getLoginUrl(-1);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                    print <span class="stringliteral">&#39;&amp;nbsp;&#39;</span>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                print <span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.(!empty($totalpay) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a4f4158875f7336eb9999442262e48eee">price</a>($totalpay, 0, $langs) : <span class="stringliteral">&#39;&#39;</span>).<span class="stringliteral">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span>; <span class="comment">// TODO Use a denormalized field</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;totalam&#39;</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;totalam&#39;</span>] += $totalpay;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&#39;</span>.(!empty($remaintopay) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a4f4158875f7336eb9999442262e48eee">price</a>($remaintopay, 0, $langs) : <span class="stringliteral">&#39;&amp;nbsp;&#39;</span>).<span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>; <span class="comment">// TODO Use a denormalized field</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                    $totalarray[<span class="stringliteral">&#39;pos&#39;</span>][$totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]] = <span class="stringliteral">&#39;rtp&#39;</span>;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                $totalarray[<span class="stringliteral">&#39;val&#39;</span>][<span class="stringliteral">&#39;rtp&#39;</span>] += $remaintopay;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="comment">// Currency</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_code&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                  print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>.$obj-&gt;multicurrency_code.<span class="stringliteral">&#39; - &#39;</span>.$langs-&gt;trans(<span class="stringliteral">&#39;Currency&#39;</span>.$obj-&gt;multicurrency_code).<span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <span class="comment">// Currency rate</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_tx&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                  print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                  $form-&gt;form_multicurrency_rate($_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>].<span class="stringliteral">&#39;?id=&#39;</span>.$obj-&gt;rowid, $obj-&gt;multicurrency_tx, <span class="stringliteral">&#39;none&#39;</span>, $obj-&gt;multicurrency_code);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                  print <span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="comment">// Amount HT</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ht&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                  print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;multicurrency_total_ht).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="comment">// Amount VAT</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_vat&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;multicurrency_total_vat).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            <span class="comment">// Amount TTC</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.multicurrency_total_ttc&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.price($obj-&gt;multicurrency_total_ttc).<span class="stringliteral">&quot;&lt;/span&gt;&lt;/td&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_dynamount_payed&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>.(!empty($multicurrency_totalpay) ?<a class="code" href="../../d9/d69/functions_8lib_8php.html#a4f4158875f7336eb9999442262e48eee">price</a>($multicurrency_totalpay, 0, $langs) : <span class="stringliteral">&#39;&#39;</span>).<span class="stringliteral">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span>; <span class="comment">// TODO Use a denormalized field</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="comment">// Pending amount</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;multicurrency_rtp&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&lt;span class=&quot;amount&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                print (!empty($multicurrency_remaintopay) ? <a class="code" href="../../d9/d69/functions_8lib_8php.html#a4f4158875f7336eb9999442262e48eee">price</a>($multicurrency_remaintopay, 0, $langs) : <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                print <span class="stringliteral">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span>; <span class="comment">// TODO Use a denormalized field</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="comment">// Extra fields</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/extrafields_list_print_fields.tpl.php&#39;</span>;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="comment">// Fields from hook</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            $parameters = array(<span class="stringliteral">&#39;arrayfields&#39;</span>=&gt;$arrayfields, <span class="stringliteral">&#39;obj&#39;</span>=&gt;$obj, <span class="charliteral">&#39;i&#39;</span>=&gt;$i, <span class="stringliteral">&#39;totalarray&#39;</span>=&gt;&amp;$totalarray);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListValue&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            print $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            <span class="comment">// Date creation</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.datec&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                print <a class="code" href="../../d9/d69/functions_8lib_8php.html#a52dc9c15ed0565a4b8312dc7d7d41fcb">dol_print_date</a>($db-&gt;jdate($obj-&gt;date_creation), <span class="stringliteral">&#39;dayhour&#39;</span>, <span class="stringliteral">&#39;tzuser&#39;</span>);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            <span class="comment">// Date modification</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.tms&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;center nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                print <a class="code" href="../../d9/d69/functions_8lib_8php.html#a52dc9c15ed0565a4b8312dc7d7d41fcb">dol_print_date</a>($db-&gt;jdate($obj-&gt;date_update), <span class="stringliteral">&#39;dayhour&#39;</span>, <span class="stringliteral">&#39;tzuser&#39;</span>);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="comment">// Status</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            <span class="keywordflow">if</span> (!empty($arrayfields[<span class="stringliteral">&#39;f.fk_statut&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>])) {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                print <span class="stringliteral">&#39;&lt;td class=&quot;right nowrap&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                print $facturestatic-&gt;LibStatut($obj-&gt;paye, $obj-&gt;fk_statut, 5, $paiement, $obj-&gt;type);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                print <span class="stringliteral">&quot;&lt;/td&gt;&quot;</span>;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                    $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="comment">// Action column</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            print <span class="stringliteral">&#39;&lt;td class=&quot;nowrap center&quot;&gt;&#39;</span>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            <span class="keywordflow">if</span> ($massactionbutton || $massaction) {   <span class="comment">// If we are in select mode (massactionbutton defined) or if we have already selected and sent an action ($massaction) defined</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                $selected = 0;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                <span class="keywordflow">if</span> (in_array($obj-&gt;facid, $arrayofselected)) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    $selected = 1;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                print <span class="stringliteral">&#39;&lt;input id=&quot;cb&#39;</span>.$obj-&gt;facid.<span class="stringliteral">&#39;&quot; class=&quot;flat checkforselect&quot; type=&quot;checkbox&quot; name=&quot;toselect[]&quot; value=&quot;&#39;</span>.$obj-&gt;facid.<span class="charliteral">&#39;&quot;&#39;</span>.($selected ? <span class="stringliteral">&#39; checked=&quot;checked&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).<span class="charliteral">&#39;&gt;&#39;</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            print <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <span class="keywordflow">if</span> (!$i) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                $totalarray[<span class="stringliteral">&#39;nbfield&#39;</span>]++;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            print <span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            $i++;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="comment">// Show total line</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        include DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/tpl/list_print_total.tpl.php&#39;</span>;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    $db-&gt;free(<a class="code" href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a>);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    $parameters = array(<span class="stringliteral">&#39;arrayfields&#39;</span>=&gt;$arrayfields, <span class="stringliteral">&#39;sql&#39;</span>=&gt;$sql);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    $reshook = $hookmanager-&gt;executeHooks(<span class="stringliteral">&#39;printFieldListFooter&#39;</span>, $parameters); <span class="comment">// Note that $action and $object may have been modified by hook</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    print $hookmanager-&gt;resPrint;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    print <span class="stringliteral">&quot;&lt;/table&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    print <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    print <span class="stringliteral">&quot;&lt;/form&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; </div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    $hidegeneratedfilelistifempty = 1;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">if</span> ($massaction == <span class="stringliteral">&#39;builddoc&#39;</span> || $action == <span class="stringliteral">&#39;remove_file&#39;</span> || $show_files) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        $hidegeneratedfilelistifempty = 0;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// Show list of available documents</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    $urlsource = $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>].<span class="stringliteral">&#39;?sortfield=&#39;</span>.$sortfield.<span class="stringliteral">&#39;&amp;sortorder=&#39;</span>.$sortorder;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    $urlsource .= str_replace(<span class="stringliteral">&#39;&amp;amp;&#39;</span>, <span class="charliteral">&#39;&amp;&#39;</span>, $param);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    $filedir = $diroutputmassaction;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    $genallowed = $user-&gt;rights-&gt;facture-&gt;lire;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    $delallowed = $user-&gt;rights-&gt;facture-&gt;creer;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="../../d8/da5/salaries_2card_8php.html#a1b723a6fbede58e4c27d39f8e52cd909">$title</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    print $formfile-&gt;showdocuments(<span class="stringliteral">&#39;massfilesarea_supplier_invoice&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $filedir, $urlsource, 0, $delallowed, <span class="stringliteral">&#39;&#39;</span>, 1, 1, 0, 48, 1, $param, <a class="code" href="../../d8/da5/salaries_2card_8php.html#a1b723a6fbede58e4c27d39f8e52cd909">$title</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">null</span>, $hidegeneratedfilelistifempty);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;} <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a>($db);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;}</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">// End of page</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<a class="code" href="../../d6/d7c/asterisk_2wrapper_8php.html#aebbb85b0adc465834787866f31885fc5">llxFooter</a>();</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;$db-&gt;close();</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_societe_html"><div class="ttname"><a href="../../dc/dbc/class_societe.html">Societe</a></div><div class="ttdoc">Class to manage third parties objects (customers, suppliers, prospects...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d91/societe_8class_8php_source.html#l00047">societe.class.php:47</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_ac3be82e6fd86f4f54522be5c5453b981"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#ac3be82e6fd86f4f54522be5c5453b981">dol_sanitizeFileName</a></div><div class="ttdeci">dol_sanitizeFileName($str, $newstr='_', $unaccent=1)</div><div class="ttdoc">Clean a string to use it as a file name.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l01083">functions.lib.php:1083</a></div></div>
<div class="ttc" id="aasterisk_2wrapper_8php_html_aebbb85b0adc465834787866f31885fc5"><div class="ttname"><a href="../../d6/d7c/asterisk_2wrapper_8php.html#aebbb85b0adc465834787866f31885fc5">llxFooter</a></div><div class="ttdeci">llxFooter()</div><div class="ttdoc">Empty footer.</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7c/asterisk_2wrapper_8php_source.html#l00073">wrapper.php:73</a></div></div>
<div class="ttc" id="aclass_project_html"><div class="ttname"><a href="../../d9/d6e/class_project.html">Project</a></div><div class="ttdoc">Class to manage projects.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbf/project_8class_8php_source.html#l00034">project.class.php:34</a></div></div>
<div class="ttc" id="asalaries_2card_8php_html_a1b723a6fbede58e4c27d39f8e52cd909"><div class="ttname"><a href="../../d8/da5/salaries_2card_8php.html#a1b723a6fbede58e4c27d39f8e52cd909">$title</a></div><div class="ttdeci">if($cancel) if($action=='classin' &amp;&amp; $user-&gt;rights-&gt;banque-&gt;modifier) if($action=='setlabel' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='confirm_paid' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write &amp;&amp; $confirm=='yes') if($action=='setfk_user' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='reopen' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='setmode' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='setbankaccount' &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='add' &amp;&amp;empty($cancel)) if($action=='confirm_delete') if($action=='update' &amp;&amp;!GETPOST(&quot;cancel&quot;) &amp;&amp; $user-&gt;rights-&gt;salaries-&gt;write) if($action=='confirm_clone' &amp;&amp; $confirm !='yes') if($action=='confirm_clone' &amp;&amp; $confirm=='yes' &amp;&amp;($user-&gt;rights-&gt;salaries-&gt;write)) if($action==&quot;update_extras&quot; &amp;&amp;!empty($user-&gt;rights-&gt;salaries-&gt;read)) $title</div><div class="ttdoc">Actions.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da5/salaries_2card_8php_source.html#l00401">card.php:401</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a97dc8c4d4db97a060f48e220a1f9f293"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a97dc8c4d4db97a060f48e220a1f9f293">GETPOST</a></div><div class="ttdeci">GETPOST($paramname, $check='alphanohtml', $method=0, $filter=null, $options=null, $noreplace=0)</div><div class="ttdoc">Return value of a param into GET or POST supervariable.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l00391">functions.lib.php:391</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html">FactureFournisseur</a></div><div class="ttdoc">Class to manage suppliers invoices.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00052">fournisseur.facture.class.php:52</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a39a0441491a380f7f9fe07ee296cd2fa"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a></div><div class="ttdeci">dol_print_error($db='', $error='', $errors=null)</div><div class="ttdoc">Displays error message system with all the information to facilitate the diagnosis and the escalation...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l04503">functions.lib.php:4503</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a6b591763a56a351b27fe6575fb3d664d"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a6b591763a56a351b27fe6575fb3d664d">dol_sort_array</a></div><div class="ttdeci">dol_sort_array(&amp;$array, $index, $order='asc', $natsort=0, $case_sensitive=0, $keepindex=0)</div><div class="ttdoc">Advanced sort array by second index function, which produces ascending (default) or descending output...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l07918">functions.lib.php:7918</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html_a7f4ad3d12b7cf8b15d466a81da201e2d"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html#a7f4ad3d12b7cf8b15d466a81da201e2d">FactureFournisseur\TYPE_STANDARD</a></div><div class="ttdeci">const TYPE_STANDARD</div><div class="ttdoc">Standard invoice.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00308">fournisseur.facture.class.php:308</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a1b743ba3487d5ca14c5f0a86a07edc71"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a1b743ba3487d5ca14c5f0a86a07edc71">img_warning</a></div><div class="ttdeci">img_warning($titlealt='default', $moreatt='', $morecss='pictowarning')</div><div class="ttdoc">Show warning logo.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l04180">functions.lib.php:4180</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html_aee7d4c2527e22a8cad7d0bc1f77af318"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html#aee7d4c2527e22a8cad7d0bc1f77af318">FactureFournisseur\TYPE_DEPOSIT</a></div><div class="ttdeci">const TYPE_DEPOSIT</div><div class="ttdoc">Deposit invoice.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00323">fournisseur.facture.class.php:323</a></div></div>
<div class="ttc" id="aclass_form_other_html"><div class="ttname"><a href="../../d0/dbd/class_form_other.html">FormOther</a></div><div class="ttdoc">Classe permettant la generation de composants html autre Only common components are here.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dda/html_8formother_8class_8php_source.html#l00039">html.formother.class.php:39</a></div></div>
<div class="ttc" id="acompta_2index_8php_html_a14a5de89426ca4a6f25720be81061c90"><div class="ttname"><a href="../../d9/d3c/compta_2index_8php.html#a14a5de89426ca4a6f25720be81061c90">$resql</a></div><div class="ttdeci">if(!empty($conf-&gt;facture-&gt;enabled) &amp;&amp;!empty($user-&gt;rights-&gt;facture-&gt;lire)) if((!empty($conf-&gt;fournisseur-&gt;enabled) &amp;&amp;empty($conf-&gt;global-&gt;MAIN_USE_NEW_SUPPLIERMOD) &amp;&amp; $user-&gt;rights-&gt;fournisseur-&gt;facture-&gt;lire)||(!empty($conf-&gt;supplier_invoice-&gt;enabled) &amp;&amp; $user-&gt;rights-&gt;supplier_invoice-&gt;lire)) if(!empty($conf-&gt;don-&gt;enabled) &amp;&amp;!empty($user-&gt;rights-&gt;don-&gt;lire)) if(!empty($conf-&gt;tax-&gt;enabled) &amp;&amp;!empty($user-&gt;rights-&gt;tax-&gt;charges-&gt;lire)) if(!empty($conf-&gt;facture-&gt;enabled) &amp;&amp;!empty($conf-&gt;commande-&gt;enabled) &amp;&amp; $user-&gt;rights-&gt;commande-&gt;lire &amp;&amp;empty($conf-&gt;global-&gt;WORKFLOW_DISABLE_CREATE_INVOICE_FROM_ORDER)) $resql</div><div class="ttdoc">Social contributions to pay.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d3c/compta_2index_8php_source.html#l00733">index.php:733</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a34644574d03047e0104710288a28ac91"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a34644574d03047e0104710288a28ac91">price2num</a></div><div class="ttdeci">price2num($amount, $rounding='', $option=0)</div><div class="ttdoc">Function that return a number with universal decimal format (decimal separator is '.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l05315">functions.lib.php:5315</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a52dc9c15ed0565a4b8312dc7d7d41fcb"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a52dc9c15ed0565a4b8312dc7d7d41fcb">dol_print_date</a></div><div class="ttdeci">dol_print_date($time, $format='', $tzoutput='auto', $outputlangs='', $encodetooutput=false)</div><div class="ttdoc">Output date in a string format according to outputlangs (or langs if not defined).</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l02286">functions.lib.php:2286</a></div></div>
<div class="ttc" id="aclass_form_company_html"><div class="ttname"><a href="../../d2/d52/class_form_company.html">FormCompany</a></div><div class="ttdoc">Class to build HTML component for third parties management Only common components are here.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df4/html_8formcompany_8class_8php_source.html#l00040">html.formcompany.class.php:40</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a64fc44ee4f3329fe0ff256b57bffc128"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a64fc44ee4f3329fe0ff256b57bffc128">img_picto</a></div><div class="ttdeci">img_picto($titlealt, $picto, $moreatt='', $pictoisfullpath=false, $srconly=0, $notitle=0, $alt='', $morecss='', $marginleftonlyshort=2)</div><div class="ttdoc">Show picto whatever it's its name (generic function)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l03588">functions.lib.php:3588</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_af47175099567f74f62e2e428ff8a26dd"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#af47175099567f74f62e2e428ff8a26dd">get_exdir</a></div><div class="ttdeci">get_exdir($num, $level, $alpha, $withoutslash, $object, $modulepart='')</div><div class="ttdoc">Return a path to have a the directory according to object where files are stored.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l06190">functions.lib.php:6190</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html_ad2fb708f4565e0c40e0a657508e4e9a1"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html#ad2fb708f4565e0c40e0a657508e4e9a1">FactureFournisseur\TYPE_REPLACEMENT</a></div><div class="ttdeci">const TYPE_REPLACEMENT</div><div class="ttdoc">Replacement invoice.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00313">fournisseur.facture.class.php:313</a></div></div>
<div class="ttc" id="aclass_form_file_html"><div class="ttname"><a href="../../de/d23/class_form_file.html">FormFile</a></div><div class="ttdoc">Class to offer components to list and upload files.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d98/html_8formfile_8class_8php_source.html#l00036">html.formfile.class.php:36</a></div></div>
<div class="ttc" id="aclass_fournisseur_html"><div class="ttname"><a href="../../de/d1a/class_fournisseur.html">Fournisseur</a></div><div class="ttdoc">Class to manage suppliers.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc6/fournisseur_8class_8php_source.html#l00034">fournisseur.class.php:34</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a39a4807115abf884f121a03c282fd032"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a39a4807115abf884f121a03c282fd032">dolGetButtonTitle</a></div><div class="ttdeci">dolGetButtonTitle($label, $helpText='', $iconClass='fa fa-file', $url='', $id='', $status=1, $params=array())</div><div class="ttdoc">Function dolGetButtonTitle : this kind of buttons are used in title in list.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l10028">functions.lib.php:10028</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_aabdd318c9960cbb2e505161e64eace1c"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#aabdd318c9960cbb2e505161e64eace1c">print_barre_liste</a></div><div class="ttdeci">print_barre_liste($titre, $page, $file, $options='', $sortfield='', $sortorder='', $morehtmlcenter='', $num=-1, $totalnboflines='', $picto='generic', $pictoisfullpath=0, $morehtmlright='', $morecss='', $limit=-1, $hideselectlimit=0, $hidenavigation=0, $pagenavastextinput=0, $morehtmlrightbeforearrow='')</div><div class="ttdoc">Print a title with navigation controls for pagination.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l04918">functions.lib.php:4918</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html_ad94bc08e9cfeb9cd3d8a9b2343f306c7"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html#ad94bc08e9cfeb9cd3d8a9b2343f306c7">FactureFournisseur\TYPE_CREDIT_NOTE</a></div><div class="ttdeci">const TYPE_CREDIT_NOTE</div><div class="ttdoc">Credit note invoice.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00318">fournisseur.facture.class.php:318</a></div></div>
<div class="ttc" id="aclass_user_html"><div class="ttname"><a href="../../d7/d23/class_user.html">User</a></div><div class="ttdoc">Class to manage Dolibarr users.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/user_8class_8php_source.html#l00044">user.class.php:44</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_aca64a844ce2ad30d4fc49cd4b957cbdf"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#aca64a844ce2ad30d4fc49cd4b957cbdf">GETPOSTISSET</a></div><div class="ttdeci">GETPOSTISSET($paramname)</div><div class="ttdoc">Return true if we are in a context of submitting the parameter $paramname from a POST of a form.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l00321">functions.lib.php:321</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a74196ba6e0686fb0a4646e4b9cb92355"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a74196ba6e0686fb0a4646e4b9cb92355">print_liste_field_titre</a></div><div class="ttdeci">print_liste_field_titre($name, $file=&quot;&quot;, $field=&quot;&quot;, $begin=&quot;&quot;, $moreparam=&quot;&quot;, $moreattrib=&quot;&quot;, $sortfield=&quot;&quot;, $sortorder=&quot;&quot;, $prefix=&quot;&quot;, $tooltip=&quot;&quot;, $forcenowrapcolumntitle=0)</div><div class="ttdoc">Show title line of an array.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l04685">functions.lib.php:4685</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a46f24284833ccc2de3a8a0d703293287"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a46f24284833ccc2de3a8a0d703293287">natural_search</a></div><div class="ttdeci">natural_search($fields, $value, $mode=0, $nofirstand=0)</div><div class="ttdoc">Generate natural SQL search string for a criteria (this criteria can be tested on one or several fiel...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l08861">functions.lib.php:8861</a></div></div>
<div class="ttc" id="aclass_extra_fields_html"><div class="ttname"><a href="../../d3/dbf/class_extra_fields.html">ExtraFields</a></div><div class="ttdoc">Class to manage standard extra fields.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d18/extrafields_8class_8php_source.html#l00038">extrafields.class.php:38</a></div></div>
<div class="ttc" id="aclass_form_html"><div class="ttname"><a href="../../df/d08/class_form.html">Form</a></div><div class="ttdoc">Class to manage generation of HTML components Only common components must be here.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d05/html_8form_8class_8php_source.html#l00052">html.form.class.php:52</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a5e66578bb4ca51676bad5d37e19e7e1a"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a></div><div class="ttdeci">dol_now($mode='auto')</div><div class="ttdoc">Return date for now.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l02614">functions.lib.php:2614</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a4f4158875f7336eb9999442262e48eee"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a4f4158875f7336eb9999442262e48eee">price</a></div><div class="ttdeci">price($amount, $form=0, $outlangs='', $trunc=1, $rounding=-1, $forcerounding=-1, $currency_code='')</div><div class="ttdoc">Function to format a value into an amount for visual output Function used into PDF and HTML pages.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l05201">functions.lib.php:5201</a></div></div>
<div class="ttc" id="acompany_8lib_8php_html_a73a2dc5e3c857a36bdcd0a9fcdc40933"><div class="ttname"><a href="../../d5/d2b/company_8lib_8php.html#a73a2dc5e3c857a36bdcd0a9fcdc40933">getCountry</a></div><div class="ttdeci">getCountry($searchkey, $withcode='', $dbtouse=0, $outputlangs='', $entconv=1, $searchlabel='')</div><div class="ttdoc">Return country label, code or id from an id, code or label.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d2b/company_8lib_8php_source.html#l00497">company.lib.php:497</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a4a25c44d5cda2ec236161511fadde188"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a4a25c44d5cda2ec236161511fadde188">setEventMessages</a></div><div class="ttdeci">setEventMessages($mesg, $mesgs, $style='mesgs', $messagekey='')</div><div class="ttdoc">Set event messages in dol_events session object.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l07668">functions.lib.php:7668</a></div></div>
<div class="ttc" id="asecurity_8lib_8php_html_ade2525beed17cc74b84932ff7483231d"><div class="ttname"><a href="../../dd/df3/security_8lib_8php.html#ade2525beed17cc74b84932ff7483231d">accessforbidden</a></div><div class="ttdeci">accessforbidden($message='', $printheader=1, $printfooter=1, $showonlymessage=0, $params=null)</div><div class="ttdoc">Show a message to say access is forbidden and stop program Calling this function terminate execution ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/security_8lib_8php_source.html#l00818">security.lib.php:818</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a09ae0028df30935f6a6f7d5ae05f42bd"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a09ae0028df30935f6a6f7d5ae05f42bd">dol_mktime</a></div><div class="ttdeci">dol_mktime($hour, $minute, $second, $month, $day, $year, $gm='auto', $check=1)</div><div class="ttdoc">Return a timestamp date built from detailed informations (by default a local PHP server timestamp) Re...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l02526">functions.lib.php:2526</a></div></div>
<div class="ttc" id="aclass_facture_fournisseur_html_ac39e16e98e33ffb1fae8298df5a20383"><div class="ttname"><a href="../../df/d8a/class_facture_fournisseur.html#ac39e16e98e33ffb1fae8298df5a20383">FactureFournisseur\STATUS_DRAFT</a></div><div class="ttdeci">const STATUS_DRAFT</div><div class="ttdoc">Draft.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df0/fournisseur_8facture_8class_8php_source.html#l00328">fournisseur.facture.class.php:328</a></div></div>
<div class="ttc" id="aasterisk_2wrapper_8php_html_abcab7df295b4869f8dfb1dd7059fd974"><div class="ttname"><a href="../../d6/d7c/asterisk_2wrapper_8php.html#abcab7df295b4869f8dfb1dd7059fd974">llxHeader</a></div><div class="ttdeci">if(!defined('NOREQUIRESOC')) if(!defined('NOREQUIRETRAN')) if(!defined('NOCSRFCHECK')) if(!defined('NOTOKENRENEWAL')) if(!defined('NOREQUIREMENU')) if(!defined('NOREQUIREHTML')) if(!defined('NOREQUIREAJAX')) llxHeader()</div><div class="ttdoc">Empty header.</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7c/asterisk_2wrapper_8php_source.html#l00059">wrapper.php:59</a></div></div>
<div class="ttc" id="aclass_account_html"><div class="ttname"><a href="../../db/d22/class_account.html">Account</a></div><div class="ttdoc">Class to manage bank accounts.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d6f/account_8class_8php_source.html#l00038">account.class.php:38</a></div></div>
<!-- 
File added into doxygen generated documentation
-->
<hr class="footer" />
<address class="footer"><small>Generated on Tue Oct 19 2021 22:53:03 for <a href="https://www.dolibarr.org" title="ERP and CRM open source software">Dolibarr</a> by Doxygen 1.8.17 </small></address>
<br>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-9049390-16"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-9049390-16');
</script>
</body>
</html>