<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dolibarr: htdocs/core/modules/modEmailCollector.class.php Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../dolibarr.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dolibarr
   &#160;<span id="projectnumber">14.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d0/d7a/mod_email_collector_8class_8php_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">modEmailCollector.class.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/d7a/mod_email_collector_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* Copyright (C) 2004-2018 Laurent Destailleur  &lt;eldy@users.sourceforge.net&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation; either version 3 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program. If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;include_once DOL_DOCUMENT_ROOT.<span class="stringliteral">&#39;/core/modules/DolibarrModules.class.php&#39;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="../../d5/d6c/classmod_email_collector.html">   32</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d5/d6c/classmod_email_collector.html">modEmailCollector</a> <span class="keyword">extends</span> <a class="code" href="../../d0/d8f/class_dolibarr_modules.html">DolibarrModules</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="../../d5/d6c/classmod_email_collector.html#a800f8efee13692788b13ee57c5960092">   39</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d5/d6c/classmod_email_collector.html#a800f8efee13692788b13ee57c5960092">__construct</a>($db)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        global $langs, $conf;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a> = $db;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="comment">// Id for module (must be unique).</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">// Use here a free id (See in Home -&gt; System information -&gt; Dolibarr for list of used modules id).</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        $this-&gt;numero = 50320;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="comment">// Key text used to identify module (for permissions, menus, etc...)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        $this-&gt;rights_class = <span class="stringliteral">&#39;emailcollector&#39;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">// Family can be &#39;base&#39; (core modules),&#39;crm&#39;,&#39;financial&#39;,&#39;hr&#39;,&#39;projects&#39;,&#39;products&#39;,&#39;ecm&#39;,&#39;technic&#39; (transverse modules),&#39;interface&#39; (link with external tools),&#39;other&#39;,&#39;...&#39;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// It is used to group modules by family in module setup page</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        $this-&gt;family = <span class="stringliteral">&quot;interface&quot;</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">// Module position in the family on 2 digits (&#39;01&#39;, &#39;10&#39;, &#39;20&#39;, ...)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        $this-&gt;module_position = <span class="stringliteral">&#39;23&#39;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// Gives the possibility to the module, to provide his own family info and position of this family (Overwrite $this-&gt;family and $this-&gt;module_position. Avoid this)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">//$this-&gt;familyinfo = array(&#39;myownfamily&#39; =&gt; array(&#39;position&#39; =&gt; &#39;01&#39;, &#39;label&#39; =&gt; $langs-&gt;trans(&quot;MyOwnFamily&quot;)));</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">// Module label (no space allowed), used if translation string &#39;ModuledavName&#39; not found (MyModue is name of module).</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        $this-&gt;<a class="code" href="../../d1/d2d/repair_8php.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = preg_replace(<span class="stringliteral">&#39;/^mod/i&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, get_class($this));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">// Module description, used if translation string &#39;ModuledavDesc&#39; not found (MyModue is name of module).</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        $this-&gt;<a class="code" href="../../d5/d94/replenish_8php.html#a23af17c78302b71c14ef38ea40b8d1d7">description</a> = <span class="stringliteral">&quot;EmailCollectorDescription&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">// Used only if file README.md and README-LL.md not found.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        $this-&gt;descriptionlong = <span class="stringliteral">&quot;EmailCollectorDescription&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Possible values for version are: &#39;development&#39;, &#39;experimental&#39;, &#39;dolibarr&#39;, &#39;dolibarr_deprecated&#39; or a version string like &#39;x.y.z&#39;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        $this-&gt;version = <span class="stringliteral">&#39;dolibarr&#39;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// Key used in llx_const table to save module status enabled/disabled (where DAV is value of property name of module in uppercase)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        $this-&gt;const_name = <span class="stringliteral">&#39;MAIN_MODULE_&#39;</span>.strtoupper($this-&gt;<a class="code" href="../../d1/d2d/repair_8php.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// Name of image file used for this module.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">// If file is in theme/yourtheme/img directory under name object_pictovalue.png, use this-&gt;picto=&#39;pictovalue&#39;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">// If file is in module/img directory under name object_pictovalue.png, use this-&gt;picto=&#39;pictovalue@module&#39;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        $this-&gt;picto = <span class="stringliteral">&#39;email&#39;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">// Defined all module parts (triggers, login, substitutions, menus, css, etc...)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">// for default path (eg: /dav/core/xxxxx) (0=disable, 1=enable)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// for specific path of parts (eg: /dav/core/modules/barcode)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">// for specific css file (eg: /dav/css/dav.css.php)</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        $this-&gt;module_parts = array();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Data directories to create when module is enabled.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// Example: this-&gt;dirs = array(&quot;/dav/temp&quot;,&quot;/dav/subdir&quot;);</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        $this-&gt;dirs = array();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// Config pages. Put here list of php page, stored into dav/admin directory, to use to setup module.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        $this-&gt;config_page_url = array(<span class="stringliteral">&quot;emailcollector_list.php&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Dependencies</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        $this-&gt;hidden = <span class="keyword">false</span>; <span class="comment">// A condition to hide module</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        $this-&gt;depends = array(<span class="stringliteral">&#39;always&#39;</span>=&gt;<span class="stringliteral">&#39;modCron&#39;</span>); <span class="comment">// List of module class names as string that must be enabled if this module is enabled</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        $this-&gt;requiredby = array(); <span class="comment">// List of module ids to disable if this one is disabled</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        $this-&gt;conflictwith = array(); <span class="comment">// List of module class names as string this module is in conflict with</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        $this-&gt;langfiles = array(<span class="stringliteral">&quot;admin&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        $this-&gt;phpmin = array(5, 6); <span class="comment">// Minimum version of PHP required by module</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        $this-&gt;need_dolibarr_version = array(7, 0); <span class="comment">// Minimum version of Dolibarr required by module</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        $this-&gt;warnings_activation = array(); <span class="comment">// Warning to show when we activate module. array(&#39;always&#39;=&#39;text&#39;) or array(&#39;FR&#39;=&#39;textfr&#39;,&#39;ES&#39;=&#39;textes&#39;...)</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        $this-&gt;warnings_activation_ext = array(); <span class="comment">// Warning to show when we activate an external module. array(&#39;always&#39;=&#39;text&#39;) or array(&#39;FR&#39;=&#39;textfr&#39;,&#39;ES&#39;=&#39;textes&#39;...)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">//$this-&gt;automatic_activation = array(&#39;FR&#39;=&gt;&#39;davWasAutomaticallyActivatedBecauseOfYourCountryChoice&#39;);</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">//$this-&gt;always_enabled = true;                             // If true, can&#39;t be disabled</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// Constants</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// List of particular constants to add when module is enabled (key, &#39;chaine&#39;, value, desc, visible, &#39;current&#39; or &#39;allentities&#39;, deleteonunactive)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">// Example: $this-&gt;const=array(0=&gt;array(&#39;DAV_MYNEWCONST1&#39;,&#39;chaine&#39;,&#39;myvalue&#39;,&#39;This is a constant to add&#39;,1),</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">//                             1=&gt;array(&#39;DAV_MYNEWCONST2&#39;,&#39;chaine&#39;,&#39;myvalue&#39;,&#39;This is another constant to add&#39;,0, &#39;current&#39;, 1)</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// );</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        $this-&gt;<span class="keyword">const</span> = array(</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="comment">//1=&gt;array(&#39;DAV_MYCONSTANT&#39;, &#39;chaine&#39;, &#39;avalue&#39;, &#39;This is a constant to add&#39;, 1, &#39;allentities&#39;, 1)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (!isset($conf-&gt;emailcollector) || !isset($conf-&gt;emailcollector-&gt;enabled)) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            $conf-&gt;emailcollector = <span class="keyword">new</span> stdClass();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            $conf-&gt;emailcollector-&gt;enabled = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// Array to add new pages in new tabs</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        $this-&gt;tabs = array();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Example:</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// $this-&gt;tabs[] = array(&#39;data&#39;=&gt;&#39;objecttype:+tabname1:Title1:mylangfile@dav:$user-&gt;rights-&gt;dav-&gt;read:/dav/mynewtab1.php?id=__ID__&#39;);                   // To add a new tab identified by code tabname1</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// $this-&gt;tabs[] = array(&#39;data&#39;=&gt;&#39;objecttype:+tabname2:SUBSTITUTION_Title2:mylangfile@dav:$user-&gt;rights-&gt;othermodule-&gt;read:/dav/mynewtab2.php?id=__ID__&#39;,   // To add another new tab identified by code tabname2. Label will be result of calling all substitution functions on &#39;Title2&#39; key.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// $this-&gt;tabs[] = array(&#39;data&#39;=&gt;&#39;objecttype:-tabname:NU:conditiontoremove&#39;);                                                                                           // To remove an existing tab identified by code tabname</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">// Where objecttype can be</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// &#39;categories_x&#39;     to add a tab in category view (replace &#39;x&#39; by type of category (0=product, 1=supplier, 2=customer, 3=member)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// &#39;contact&#39;          to add a tab in contact view</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">// &#39;contract&#39;         to add a tab in contract view</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// &#39;group&#39;            to add a tab in group view</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// &#39;intervention&#39;     to add a tab in intervention view</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// &#39;invoice&#39;          to add a tab in customer invoice view</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// &#39;invoice_supplier&#39; to add a tab in supplier invoice view</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// &#39;member&#39;           to add a tab in fundation member view</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// &#39;opensurveypoll&#39;   to add a tab in opensurvey poll view</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">// &#39;order&#39;            to add a tab in customer order view</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">// &#39;order_supplier&#39;   to add a tab in supplier order view</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">// &#39;payment&#39;          to add a tab in payment view</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">// &#39;payment_supplier&#39; to add a tab in supplier payment view</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// &#39;product&#39;          to add a tab in product view</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">// &#39;propal&#39;           to add a tab in propal view</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// &#39;project&#39;          to add a tab in project view</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// &#39;stock&#39;            to add a tab in stock view</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// &#39;thirdparty&#39;       to add a tab in third party view</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// &#39;user&#39;             to add a tab in user view</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">// Dictionaries</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        $this-&gt;dictionaries = array();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">/* Example:</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">        $this-&gt;dictionaries=array(</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">            &#39;langs&#39;=&gt;&#39;mylangfile@dav&#39;,</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">            &#39;tabname&#39;=&gt;array(MAIN_DB_PREFIX.&quot;table1&quot;,MAIN_DB_PREFIX.&quot;table2&quot;,MAIN_DB_PREFIX.&quot;table3&quot;),      // List of tables we want to see into dictonnary editor</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">            &#39;tablib&#39;=&gt;array(&quot;Table1&quot;,&quot;Table2&quot;,&quot;Table3&quot;),                                                    // Label of tables</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">            &#39;tabsql&#39;=&gt;array(&#39;SELECT f.rowid as rowid, f.code, f.label, f.active FROM &#39;.MAIN_DB_PREFIX.&#39;table1 as f&#39;,&#39;SELECT f.rowid as rowid, f.code, f.label, f.active FROM &#39;.MAIN_DB_PREFIX.&#39;table2 as f&#39;,&#39;SELECT f.rowid as rowid, f.code, f.label, f.active FROM &#39;.MAIN_DB_PREFIX.&#39;table3 as f&#39;),   // Request to select fields</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">            &#39;tabsqlsort&#39;=&gt;array(&quot;label ASC&quot;,&quot;label ASC&quot;,&quot;label ASC&quot;),                                                                                   // Sort order</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">            &#39;tabfield&#39;=&gt;array(&quot;code,label&quot;,&quot;code,label&quot;,&quot;code,label&quot;),                                                                                  // List of fields (result of select to show dictionary)</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">            &#39;tabfieldvalue&#39;=&gt;array(&quot;code,label&quot;,&quot;code,label&quot;,&quot;code,label&quot;),                                                                             // List of fields (list of fields to edit a record)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">            &#39;tabfieldinsert&#39;=&gt;array(&quot;code,label&quot;,&quot;code,label&quot;,&quot;code,label&quot;),                                                                            // List of fields (list of fields for insert)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">            &#39;tabrowid&#39;=&gt;array(&quot;rowid&quot;,&quot;rowid&quot;,&quot;rowid&quot;),                                                                                                 // Name of columns with primary key (try to always name it &#39;rowid&#39;)</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">            &#39;tabcond&#39;=&gt;array($conf-&gt;dav-&gt;enabled,$conf-&gt;dav-&gt;enabled,$conf-&gt;dav-&gt;enabled)                                               // Condition to show each dictionary</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">        );</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Boxes/Widgets</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// Add here list of php file(s) stored in dav/core/boxes that contains class to show a widget.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        $this-&gt;boxes = array(</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="comment">//0=&gt;array(&#39;file&#39;=&gt;&#39;davwidget1.php@dav&#39;,&#39;note&#39;=&gt;&#39;Widget provided by dav&#39;,&#39;enabledbydefaulton&#39;=&gt;&#39;Home&#39;),</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="comment">//1=&gt;array(&#39;file&#39;=&gt;&#39;davwidget2.php@dav&#39;,&#39;note&#39;=&gt;&#39;Widget provided by dav&#39;),</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">//2=&gt;array(&#39;file&#39;=&gt;&#39;davwidget3.php@dav&#39;,&#39;note&#39;=&gt;&#39;Widget provided by dav&#39;)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// Cronjobs (List of cron jobs entries to add when module is enabled)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// unit_frequency must be 60 for minute, 3600 for hour, 86400 for day, 604800 for week</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        $this-&gt;cronjobs = array(</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            0=&gt;array(<span class="stringliteral">&#39;label&#39;</span>=&gt;<span class="stringliteral">&#39;Email collector&#39;</span>, <span class="stringliteral">&#39;priority&#39;</span>=&gt;50, <span class="stringliteral">&#39;jobtype&#39;</span>=&gt;<span class="stringliteral">&#39;method&#39;</span>, <span class="stringliteral">&#39;class&#39;</span>=&gt;<span class="stringliteral">&#39;/emailcollector/class/emailcollector.class.php&#39;</span>, <span class="stringliteral">&#39;objectname&#39;</span>=&gt;<span class="stringliteral">&#39;EmailCollector&#39;</span>, <span class="stringliteral">&#39;method&#39;</span>=&gt;<span class="stringliteral">&#39;doCollect&#39;</span>, <span class="stringliteral">&#39;parameters&#39;</span>=&gt;<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;comment&#39;</span>=&gt;<span class="stringliteral">&#39;Comment&#39;</span>, <span class="stringliteral">&#39;frequency&#39;</span>=&gt;5, <span class="stringliteral">&#39;unitfrequency&#39;</span>=&gt;60, <span class="stringliteral">&#39;status&#39;</span>=&gt;1, <span class="stringliteral">&#39;test&#39;</span>=&gt;<span class="stringliteral">&#39;$conf-&gt;emailcollector-&gt;enabled&#39;</span>)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        );</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">// Permissions</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        $this-&gt;rights = array(); <span class="comment">// Permission array used by this module</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">        $r=0;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">        $this-&gt;rights[$r][0] = $this-&gt;numero + $r;  // Permission id (must not be already used)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">        $this-&gt;rights[$r][1] = &#39;Read myobject of dav&#39;;  // Permission label</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">        $this-&gt;rights[$r][3] = 0;                   // Permission by default for new user (0/1)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">        $this-&gt;rights[$r][4] = &#39;read&#39;;              // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">        $this-&gt;rights[$r][5] = &#39;&#39;;                  // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">        $r++;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">        $this-&gt;rights[$r][0] = $this-&gt;numero + $r;  // Permission id (must not be already used)</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">        $this-&gt;rights[$r][1] = &#39;Create/Update myobject of dav&#39;; // Permission label</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">        $this-&gt;rights[$r][3] = 0;                   // Permission by default for new user (0/1)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">        $this-&gt;rights[$r][4] = &#39;write&#39;;             // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">        $this-&gt;rights[$r][5] = &#39;&#39;;                  // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">        $r++;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">        $this-&gt;rights[$r][0] = $this-&gt;numero + $r;  // Permission id (must not be already used)</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">        $this-&gt;rights[$r][1] = &#39;Delete myobject of dav&#39;;    // Permission label</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">        $this-&gt;rights[$r][3] = 0;                   // Permission by default for new user (0/1)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">        $this-&gt;rights[$r][4] = &#39;delete&#39;;                // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">        $this-&gt;rights[$r][5] = &#39;&#39;;                  // In php code, permission will be checked by test if ($user-&gt;rights-&gt;dav-&gt;level1-&gt;level2)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// Main menu entries</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        $this-&gt;menu = array(); <span class="comment">// List of menus to add</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        $r = 0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// Add here entries to declare new menus</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">/* BEGIN MODULEBUILDER TOPMENU */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">/*$this-&gt;menu[$r++]=array(&#39;fk_menu&#39;=&gt;&#39;&#39;,                            // &#39;&#39; if this is a top menu. For left menu, use &#39;fk_mainmenu=xxx&#39; or &#39;fk_mainmenu=xxx,fk_leftmenu=yyy&#39; where xxx is mainmenucode and yyy is a leftmenucode</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">                                &#39;type&#39;=&gt;&#39;top&#39;,                          // This is a Top menu entry</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">                                &#39;titre&#39;=&gt;&#39;dav&#39;,</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">                                &#39;mainmenu&#39;=&gt;&#39;dav&#39;,</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">                                &#39;leftmenu&#39;=&gt;&#39;&#39;,</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">                                &#39;url&#39;=&gt;&#39;/dav/davindex.php&#39;,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">                                &#39;langs&#39;=&gt;&#39;dav@dav&#39;,         // Lang file to use (without .lang) by module. File must be in langs/code_CODE/ directory.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">                                &#39;position&#39;=&gt;1000+$r,</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">                                &#39;enabled&#39;=&gt;&#39;$conf-&gt;dav-&gt;enabled&#39;,   // Define condition to show or hide menu entry. Use &#39;$conf-&gt;dav-&gt;enabled&#39; if entry must be visible if module is enabled.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">                                &#39;perms&#39;=&gt;&#39;1&#39;,                           // Use &#39;perms&#39;=&gt;&#39;$user-&gt;rights-&gt;dav-&gt;level1-&gt;level2&#39; if you want your menu with a permission rules</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">                                &#39;target&#39;=&gt;&#39;&#39;,</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">                                &#39;user&#39;=&gt;2);                             // 0=Menu for internal users, 1=external users, 2=both</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">/* END MODULEBUILDER TOPMENU */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">/* BEGIN MODULEBUILDER LEFTMENU MYOBJECT</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">        $this-&gt;menu[$r++]=array(    &#39;fk_menu&#39;=&gt;&#39;fk_mainmenu=dav&#39;,       // &#39;&#39; if this is a top menu. For left menu, use &#39;fk_mainmenu=xxx&#39; or &#39;fk_mainmenu=xxx,fk_leftmenu=yyy&#39; where xxx is mainmenucode and yyy is a leftmenucode</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">                                &#39;type&#39;=&gt;&#39;left&#39;,                         // This is a Left menu entry</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">                                &#39;titre&#39;=&gt;&#39;List MyObject&#39;,</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">                                &#39;mainmenu&#39;=&gt;&#39;dav&#39;,</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">                                &#39;leftmenu&#39;=&gt;&#39;dav_myobject_list&#39;,</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                                &#39;url&#39;=&gt;&#39;/dav/myobject_list.php&#39;,</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">                                &#39;langs&#39;=&gt;&#39;dav@dav&#39;,         // Lang file to use (without .lang) by module. File must be in langs/code_CODE/ directory.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">                                &#39;position&#39;=&gt;1000+$r,</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">                                &#39;enabled&#39;=&gt;&#39;$conf-&gt;dav-&gt;enabled&#39;,  // Define condition to show or hide menu entry. Use &#39;$conf-&gt;dav-&gt;enabled&#39; if entry must be visible if module is enabled. Use &#39;$leftmenu==\&#39;system\&#39;&#39; to show if leftmenu system is selected.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">                                &#39;perms&#39;=&gt;&#39;1&#39;,                           // Use &#39;perms&#39;=&gt;&#39;$user-&gt;rights-&gt;dav-&gt;level1-&gt;level2&#39; if you want your menu with a permission rules</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">                                &#39;target&#39;=&gt;&#39;&#39;,</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">                                &#39;user&#39;=&gt;2);                             // 0=Menu for internal users, 1=external users, 2=both</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">        $this-&gt;menu[$r++]=array(    &#39;fk_menu&#39;=&gt;&#39;fk_mainmenu=dav,fk_leftmenu=dav&#39;,       // &#39;&#39; if this is a top menu. For left menu, use &#39;fk_mainmenu=xxx&#39; or &#39;fk_mainmenu=xxx,fk_leftmenu=yyy&#39; where xxx is mainmenucode and yyy is a leftmenucode</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">                                &#39;type&#39;=&gt;&#39;left&#39;,                         // This is a Left menu entry</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">                                &#39;titre&#39;=&gt;&#39;New MyObject&#39;,</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">                                &#39;mainmenu&#39;=&gt;&#39;dav&#39;,</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">                                &#39;leftmenu&#39;=&gt;&#39;dav_myobject_new&#39;,</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">                                &#39;url&#39;=&gt;&#39;/dav/myobject_page.php?action=create&#39;,</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">                                &#39;langs&#39;=&gt;&#39;dav@dav&#39;,         // Lang file to use (without .lang) by module. File must be in langs/code_CODE/ directory.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">                                &#39;position&#39;=&gt;1000+$r,</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">                                &#39;enabled&#39;=&gt;&#39;$conf-&gt;dav-&gt;enabled&#39;,  // Define condition to show or hide menu entry. Use &#39;$conf-&gt;dav-&gt;enabled&#39; if entry must be visible if module is enabled. Use &#39;$leftmenu==\&#39;system\&#39;&#39; to show if leftmenu system is selected.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">                                &#39;perms&#39;=&gt;&#39;1&#39;,                           // Use &#39;perms&#39;=&gt;&#39;$user-&gt;rights-&gt;dav-&gt;level1-&gt;level2&#39; if you want your menu with a permission rules</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">                                &#39;target&#39;=&gt;&#39;&#39;,</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">                                &#39;user&#39;=&gt;2);                             // 0=Menu for internal users, 1=external users, 2=both</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">        END MODULEBUILDER LEFTMENU MYOBJECT */</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d5/d6c/classmod_email_collector.html#a5f7186083b734ab6c30f0d12f3407ff2">  264</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d5/d6c/classmod_email_collector.html#a5f7186083b734ab6c30f0d12f3407ff2">init</a>($options = <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        global $conf, $user;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">//$this-&gt;_load_tables(&#39;/dav/sql/&#39;);</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Create extrafields</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">//include_once DOL_DOCUMENT_ROOT.&#39;/core/class/extrafields.class.php&#39;;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">//$extrafields = new ExtraFields($this-&gt;db);</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//$result1=$extrafields-&gt;addExtraField(&#39;myattr1&#39;, &quot;New Attr 1 label&quot;, &#39;boolean&#39;, 1,  3, &#39;thirdparty&#39;,   0, 0, &#39;&#39;, &#39;&#39;, 1, &#39;&#39;, 0, 0, &#39;&#39;, &#39;&#39;, &#39;dav@dav&#39;, &#39;$conf-&gt;dav-&gt;enabled&#39;);</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">//$result2=$extrafields-&gt;addExtraField(&#39;myattr2&#39;, &quot;New Attr 2 label&quot;, &#39;varchar&#39;, 1, 10, &#39;project&#39;,      0, 0, &#39;&#39;, &#39;&#39;, 1, &#39;&#39;, 0, 0, &#39;&#39;, &#39;&#39;, &#39;dav@dav&#39;, &#39;$conf-&gt;dav-&gt;enabled&#39;);</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">//$result3=$extrafields-&gt;addExtraField(&#39;myattr3&#39;, &quot;New Attr 3 label&quot;, &#39;varchar&#39;, 1, 10, &#39;bank_account&#39;, 0, 0, &#39;&#39;, &#39;&#39;, 1, &#39;&#39;, 0, 0, &#39;&#39;, &#39;&#39;, &#39;dav@dav&#39;, &#39;$conf-&gt;dav-&gt;enabled&#39;);</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">//$result4=$extrafields-&gt;addExtraField(&#39;myattr4&#39;, &quot;New Attr 4 label&quot;, &#39;select&#39;,  1,  3, &#39;thirdparty&#39;,   0, 1, &#39;&#39;, array(&#39;options&#39;=&gt;array(&#39;code1&#39;=&gt;&#39;Val1&#39;,&#39;code2&#39;=&gt;&#39;Val2&#39;,&#39;code3&#39;=&gt;&#39;Val3&#39;)), 1 &#39;&#39;, 0, 0, &#39;&#39;, &#39;&#39;, &#39;dav@dav&#39;, &#39;$conf-&gt;dav-&gt;enabled&#39;);</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">//$result5=$extrafields-&gt;addExtraField(&#39;myattr5&#39;, &quot;New Attr 5 label&quot;, &#39;text&#39;,    1, 10, &#39;user&#39;,         0, 0, &#39;&#39;, &#39;&#39;, 1, &#39;&#39;, 0, 0, &#39;&#39;, &#39;&#39;, &#39;dav@dav&#39;, &#39;$conf-&gt;dav-&gt;enabled&#39;);</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        $sql = array();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        $tmpsql = <span class="stringliteral">&quot;SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Ticket_Requests&#39; and entity = &quot;</span>.$conf-&gt;entity;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        $tmpresql = $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;query($tmpsql);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> ($tmpresql) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;num_rows($tmpresql) == 0) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                $descriptionA1 = <span class="stringliteral">&#39;This collector will scan your mailbox to find emails that match some rules and create automatically a ticket (Module Ticket must be enabled) with the email informations. You can use this collector if you provide some support by email, so your ticket request will be automatically generated.&#39;</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                $descriptionA1 .= <span class="stringliteral">&#39; If the collector Collect_Responses is also enabled, when you send an email from the ticket, you may also see answers of your customers or partners directly on the ticket view.&#39;</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                $sqlforexampleA1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                $sqlforexampleA1 .= <span class="stringliteral">&quot; VALUES (&quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;, &#39;Collect_Ticket_Requets&#39;, &#39;Example to collect ticket requests&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;escape($descriptionA1).<span class="stringliteral">&quot;&#39;, &#39;INBOX&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 0)&quot;</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                $sqlforexampleFilterA1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                $sqlforexampleFilterA1 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Ticket_Requets&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;isnotanswer&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                $sqlforexampleFilterA2 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                $sqlforexampleFilterA2 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Ticket_Requets&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;withouttrackingid&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                $sqlforexampleFilterA3 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, rulevalue, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                $sqlforexampleFilterA3 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Ticket_Requets&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;to&#39;, &#39;support@example.com&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                $sqlforexampleA4 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectoraction (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                $sqlforexampleA4 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Ticket_Requets&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;ticket&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                $sql[] = $sqlforexampleA1;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                $sql[] = $sqlforexampleFilterA1;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                $sql[] = $sqlforexampleFilterA2;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                $sql[] = $sqlforexampleFilterA3;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                $sql[] = $sqlforexampleA4;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a>($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        $tmpsql = <span class="stringliteral">&quot;SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_Out&#39; and entity = &quot;</span>.$conf-&gt;entity;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        $tmpresql = $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;query($tmpsql);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> ($tmpresql) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;num_rows($tmpresql) == 0) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                $descriptionA1 = <span class="stringliteral">&#39;This collector will scan your mailbox &quot;Sent&quot; directory to find emails that was sent as an answer of another email directly from your email software and not from Dolibarr. If such an email is found, the event of answer is recorded into Dolibarr.&#39;</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                $sqlforexampleA1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                $sqlforexampleA1 .= <span class="stringliteral">&quot; VALUES (&quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;, &#39;Collect_Responses_Out&#39;, &#39;Example to collect answers to emails done from your external email software&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;escape($descriptionA1).<span class="stringliteral">&quot;&#39;, &#39;Sent&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 0)&quot;</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                $sqlforexampleFilterA1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                $sqlforexampleFilterA1 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_Out&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;isanswer&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                $sqlforexampleFilterA2 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                $sqlforexampleFilterA2 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_Out&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;withouttrackingidinmsgid&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                $sqlforexampleActionA1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectoraction (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                $sqlforexampleActionA1 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_Out&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;recordevent&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                $sql[] = $sqlforexampleA1;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                $sql[] = $sqlforexampleFilterA1;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                $sql[] = $sqlforexampleFilterA2;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                $sql[] = $sqlforexampleActionA1;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        $tmpsql = <span class="stringliteral">&quot;SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_In&#39; and entity = &quot;</span>.$conf-&gt;entity;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        $tmpresql = $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;query($tmpsql);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> ($tmpresql) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;num_rows($tmpresql) == 0) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                $descriptionB1 = <span class="stringliteral">&#39;This collector will scan your mailbox to find all emails that are an answer of an email sent from your application. An event (Module Agenda must be enabled) with the email response will be recorded at the good place. For example, if your send a commercial proposal, order, invoice or message for a ticket by email from the application, and your customer answers your email, the system will automatically catch the answer and add it into your ERP.&#39;</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                $sqlforexampleB1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                $sqlforexampleB1 .= <span class="stringliteral">&quot; VALUES (&quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;, &#39;Collect_Responses_In&#39;, &#39;Example to collect any received email that is a response of an email sent from Dolibarr&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;escape($descriptionB1).<span class="stringliteral">&quot;&#39;, &#39;INBOX&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 0)&quot;</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                $sqlforexampleB2 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                $sqlforexampleB2 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_In&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;isanswer&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                $sqlforexampleB3 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectoraction (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                $sqlforexampleB3 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Responses_In&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;recordevent&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                $sql[] = $sqlforexampleB1;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                $sql[] = $sqlforexampleB2;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                $sql[] = $sqlforexampleB3;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a>($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        $tmpsql = <span class="stringliteral">&quot;SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Leads&#39; and entity = &quot;</span>.$conf-&gt;entity;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        $tmpresql = $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;query($tmpsql);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> ($tmpresql) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;num_rows($tmpresql) == 0) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                $descriptionC1 = <span class="stringliteral">&quot;This collector will scan your mailbox to find emails that match some rules and create automatically a lead (Module Project must be enabled) with the email informations. You can use this collector if you want to follow your lead using the module Project (1 lead = 1 project), so your leads will be automatically generated.&quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                $descriptionC1 .= <span class="stringliteral">&quot; If the collector Collect_Responses is also enabled, when you send an email from your leads, proposals or any other object, you may also see answers of your customers or partners directly on the application.&lt;br&gt;&quot;</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                $descriptionC1 .= <span class="stringliteral">&quot;Note: With this initial example, the title of the lead is generated including the email. If the thirdparty can&#39;t be found in database (new customer), the lead will be attached to the thirdparty with ID 1.&quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                $sqlforexampleC1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                $sqlforexampleC1 .= <span class="stringliteral">&quot; VALUES (&quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;, &#39;Collect_Leads&#39;, &#39;Example to collect leads&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;escape($descriptionC1).<span class="stringliteral">&quot;&#39;, &#39;INBOX&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 0)&quot;</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                $sqlforexampleFilterC1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                $sqlforexampleFilterC1 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Leads&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;isnotanswer&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                $sqlforexampleFilterC2 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                $sqlforexampleFilterC2 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Leads&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;withouttrackingid&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                $sqlforexampleFilterC3 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, rulevalue, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                $sqlforexampleFilterC3 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Leads&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;to&#39;, &#39;sales@example.com&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                $sqlforexampleC4 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectoraction (fk_emailcollector, type, actionparam, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                $sqlforexampleC4 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Leads&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;project&#39;, &#39;tmp_from=EXTRACT:HEADER:^From:(.*);socid=SETIFEMPTY:1;usage_opportunity=SET:1;description=EXTRACT:BODY:(.*);title=SET:Lead or message from __tmp_from__ received by email&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                $sql[] = $sqlforexampleC1;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                $sql[] = $sqlforexampleFilterC1;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                $sql[] = $sqlforexampleFilterC2;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                $sql[] = $sqlforexampleFilterC3;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                $sql[] = $sqlforexampleC4;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a>($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        $tmpsql = <span class="stringliteral">&quot;SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Candidatures&#39; and entity = &quot;</span>.$conf-&gt;entity;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        $tmpresql = $this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;query($tmpsql);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> ($tmpresql) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;num_rows($tmpresql) == 0) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                $descriptionC1 = <span class="stringliteral">&quot;This collector will scan your mailbox to find emails send for a recruitment (Module Recruitment must be enabled). You can complete this collector if you want to automaticallycreate a candidature for a job request.&quot;</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                $descriptionC1 .= <span class="stringliteral">&quot;Note: With this initial example, the title of the candidature is generated including the email.&quot;</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                $sqlforexampleC1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector (entity, ref, label, description, source_directory, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                $sqlforexampleC1 .= <span class="stringliteral">&quot; VALUES (&quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;, &#39;Collect_Candidatures&#39;, &#39;Example to collect email for job candidatures&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;escape($descriptionC1).<span class="stringliteral">&quot;&#39;, &#39;INBOX&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 0)&quot;</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                $sqlforexampleFilterC1 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                $sqlforexampleFilterC1 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Candidatures&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;isnotanswer&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                $sqlforexampleFilterC2 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                $sqlforexampleFilterC2 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Candidatures&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;withouttrackingid&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                $sqlforexampleFilterC3 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectorfilter (fk_emailcollector, type, rulevalue, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                $sqlforexampleFilterC3 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Candidatures&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;to&#39;, &#39;jobs@example.com&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                $sqlforexampleC4 = <span class="stringliteral">&quot;INSERT INTO &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollectoraction (fk_emailcollector, type, actionparam, date_creation, fk_user_creat, status)&quot;</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                $sqlforexampleC4 .= <span class="stringliteral">&quot; VALUES ((SELECT rowid FROM &quot;</span>.MAIN_DB_PREFIX.<span class="stringliteral">&quot;emailcollector_emailcollector WHERE ref = &#39;Collect_Candidatures&#39; and entity = &quot;</span>.$conf-&gt;entity.<span class="stringliteral">&quot;), &#39;candidature&#39;, &#39;tmp_from=EXTRACT:HEADER:^From:(.*)(&lt;.*&gt;)?;fk_recruitmentjobposition=EXTRACT:HEADER:^To:[^\n]*\+([^\n]*);description=EXTRACT:BODY:(.*);lastname=SET:__tmp_from__&#39;, &#39;&quot;</span>.$this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>-&gt;idate(<a class="code" href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a>()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$user-&gt;id.<span class="stringliteral">&quot;, 1)&quot;</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                $sql[] = $sqlforexampleC1;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                $sql[] = $sqlforexampleFilterC1;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                $sql[] = $sqlforexampleFilterC2;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                $sql[] = $sqlforexampleFilterC3;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                $sql[] = $sqlforexampleC4;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a>($this-&gt;<a class="code" href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d0/d8f/class_dolibarr_modules.html#acf50e8cf48fa08c2351c1a02d1b9da78">_init</a>($sql, $options);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="../../d5/d6c/classmod_email_collector.html#ac26eda8e83f7c0afe5b00f6355a5f97d">  426</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <span class="keyword">remove</span>($options = <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        $sql = array();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d0/d8f/class_dolibarr_modules.html#a68ccfce0117c7f829fba994e683cfc2d">_remove</a>($sql, $options);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="asupport_2inc_8php_html_ac5c9be6a1c1e82d353381986a8e859b6"><div class="ttname"><a href="../../d3/d71/support_2inc_8php.html#ac5c9be6a1c1e82d353381986a8e859b6">db</a></div><div class="ttdeci">$conf db</div><div class="ttdoc">API class for accounts.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d71/support_2inc_8php_source.html#l00041">inc.php:41</a></div></div>
<div class="ttc" id="aclassmod_email_collector_html_a800f8efee13692788b13ee57c5960092"><div class="ttname"><a href="../../d5/d6c/classmod_email_collector.html#a800f8efee13692788b13ee57c5960092">modEmailCollector\__construct</a></div><div class="ttdeci">__construct($db)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7a/mod_email_collector_8class_8php_source.html#l00039">modEmailCollector.class.php:39</a></div></div>
<div class="ttc" id="aclassmod_email_collector_html_a5f7186083b734ab6c30f0d12f3407ff2"><div class="ttname"><a href="../../d5/d6c/classmod_email_collector.html#a5f7186083b734ab6c30f0d12f3407ff2">modEmailCollector\init</a></div><div class="ttdeci">init($options='')</div><div class="ttdoc">Function called when module is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7a/mod_email_collector_8class_8php_source.html#l00264">modEmailCollector.class.php:264</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a39a0441491a380f7f9fe07ee296cd2fa"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a39a0441491a380f7f9fe07ee296cd2fa">dol_print_error</a></div><div class="ttdeci">dol_print_error($db='', $error='', $errors=null)</div><div class="ttdoc">Displays error message system with all the information to facilitate the diagnosis and the escalation...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l04474">functions.lib.php:4474</a></div></div>
<div class="ttc" id="arepair_8php_html_a8ccf841cb59e451791bcb2e1ac4f1edc"><div class="ttname"><a href="../../d1/d2d/repair_8php.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a></div><div class="ttdeci">$conf db name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2d/repair_8php_source.html#l00122">repair.php:122</a></div></div>
<div class="ttc" id="areplenish_8php_html_a23af17c78302b71c14ef38ea40b8d1d7"><div class="ttname"><a href="../../d5/d94/replenish_8php.html#a23af17c78302b71c14ef38ea40b8d1d7">description</a></div><div class="ttdeci">&lt;/td &gt; param sortfield sortorder printFieldListOption&lt; td class=&quot;liste_titre maxwidthsearch right&quot;&gt;&lt;/td &gt;&lt;/tr &gt;&lt; tr class=&quot;liste_titre&quot;&gt;&lt; input type=&quot;checkbox&quot; onClick=&quot;toggle(this)&quot;/&gt; Ref p ref Label p label Duration p duration center DesiredStock p desiredstock right StockLimitShort p seuil_stock_alerte right stock_physique right stock_real_warehouse right Ordered right StockToBuy right SupplierRef right param sortfield sortorder printFieldListTitle novirtual SELECT description FROM product_lang WHERE qty&lt; br &gt; qty qty qty StockTooLow StockTooLow help help help&lt; tr class=&quot;oddeven&quot;&gt;&lt; td &gt;&lt; input type=&quot;checkbox&quot; class=&quot;check&quot; name=&quot;choose'.$i.'&quot;&gt;&lt;/td &gt;&lt; td class=&quot;nowrap&quot;&gt; stock&lt;/td &gt;&lt; td &gt;&lt; input type=&quot;hidden&quot; name=&quot;desc'.$i.'&quot; value=&quot;'.dol_escape_htmltag($objp-&gt; description</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d94/replenish_8php_source.html#l00827">replenish.php:827</a></div></div>
<div class="ttc" id="aclassmod_email_collector_html"><div class="ttname"><a href="../../d5/d6c/classmod_email_collector.html">modEmailCollector</a></div><div class="ttdoc">Description and activation class for module emailcollector.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7a/mod_email_collector_8class_8php_source.html#l00032">modEmailCollector.class.php:32</a></div></div>
<div class="ttc" id="aclass_dolibarr_modules_html_acf50e8cf48fa08c2351c1a02d1b9da78"><div class="ttname"><a href="../../d0/d8f/class_dolibarr_modules.html#acf50e8cf48fa08c2351c1a02d1b9da78">DolibarrModules\_init</a></div><div class="ttdeci">_init($array_sql, $options='')</div><div class="ttdoc">Enables a module.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da5/_dolibarr_modules_8class_8php_source.html#l00376">DolibarrModules.class.php:376</a></div></div>
<div class="ttc" id="aclass_dolibarr_modules_html_a68ccfce0117c7f829fba994e683cfc2d"><div class="ttname"><a href="../../d0/d8f/class_dolibarr_modules.html#a68ccfce0117c7f829fba994e683cfc2d">DolibarrModules\_remove</a></div><div class="ttdeci">_remove($array_sql, $options='')</div><div class="ttdoc">Disable function.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da5/_dolibarr_modules_8class_8php_source.html#l00475">DolibarrModules.class.php:475</a></div></div>
<div class="ttc" id="afunctions_8lib_8php_html_a5e66578bb4ca51676bad5d37e19e7e1a"><div class="ttname"><a href="../../d9/d69/functions_8lib_8php.html#a5e66578bb4ca51676bad5d37e19e7e1a">dol_now</a></div><div class="ttdeci">dol_now($mode='auto')</div><div class="ttdoc">Return date for now.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/functions_8lib_8php_source.html#l02593">functions.lib.php:2593</a></div></div>
<div class="ttc" id="aclass_dolibarr_modules_html"><div class="ttname"><a href="../../d0/d8f/class_dolibarr_modules.html">DolibarrModules</a></div><div class="ttdoc">Class DolibarrModules.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da5/_dolibarr_modules_8class_8php_source.html#l00037">DolibarrModules.class.php:37</a></div></div>
<!-- 
File added into doxygen generated documentation
-->
<hr class="footer" />
<address class="footer"><small>Generated on Tue Oct 19 2021 22:59:53 for <a href="https://www.dolibarr.org" title="ERP and CRM open source software">Dolibarr</a> by Doxygen 1.8.17 </small></address>
<br>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-9049390-16"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-9049390-16');
</script>
</body>
</html>